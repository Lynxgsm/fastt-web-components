import{r as t,E as e,h as n,H as i}from"./p-CXxQ9Zqa.js";function s(){const t=Date.now();const e=Math.random().toString(36).substring(2,15);return`conv_${t}_${e}`}async function r(t,e,n,i,s,r){try{const r=await fetch(`${e}/conversation/stream`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream","Cache-Control":"no-cache"},body:JSON.stringify({prompt:t,conversation_id:n})});if(!r.ok){throw new Error(`API request failed: ${r.status} ${r.statusText}`)}const o=r.body?.getReader();const a=new TextDecoder;let l="";if(!o){throw new Error("Failed to get response reader")}while(true){const{done:t,value:e}=await o.read();if(t){l+=a.decode();const t=l.split("\n");for(const e of t){if(e.startsWith("data: ")){const t=e.slice(6);if(t==="[DONE]"){s?.();return}try{const e=JSON.parse(t);if(e.content){i(e.content)}}catch(e){if(t.trim()){i(t)}}}}s?.();break}l+=a.decode(e,{stream:true});let n=l.split("\n");l=n.pop()||"";for(const t of n){if(t.startsWith("data: ")){const e=t.slice(6);if(e==="[DONE]"){s?.();return}try{const t=JSON.parse(e);if(t.content){i(t.content)}}catch(t){if(e.trim()){i(e)}}}}}}catch(t){r?.(t)}}function o(){return{async:false,baseUrl:null,breaks:false,extensions:null,gfm:true,headerIds:true,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:true,pedantic:false,renderer:null,sanitize:false,sanitizer:null,silent:false,smartypants:false,tokenizer:null,walkTokens:null,xhtml:false}}let a=o();function l(t){a=t}const c=/[&<>"']/;const h=new RegExp(c.source,"g");const d=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/;const f=new RegExp(d.source,"g");const u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};const p=t=>u[t];function g(t,e){if(e){if(c.test(t)){return t.replace(h,p)}}else{if(d.test(t)){return t.replace(f,p)}}return t}const b=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function m(t){return t.replace(b,((t,e)=>{e=e.toLowerCase();if(e==="colon")return":";if(e.charAt(0)==="#"){return e.charAt(1)==="x"?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1))}return""}))}const x=/(^|[^\[])\^/g;function k(t,e){t=typeof t==="string"?t:t.source;e=e||"";const n={replace:(e,i)=>{i=i.source||i;i=i.replace(x,"$1");t=t.replace(e,i);return n},getRegex:()=>new RegExp(t,e)};return n}const w=/[^\w:]/g;const y=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function $(t,e,n){if(t){let t;try{t=decodeURIComponent(m(n)).replace(w,"").toLowerCase()}catch(t){return null}if(t.indexOf("javascript:")===0||t.indexOf("vbscript:")===0||t.indexOf("data:")===0){return null}}if(e&&!y.test(n)){n=A(e,n)}try{n=encodeURI(n).replace(/%25/g,"%")}catch(t){return null}return n}const v={};const _=/^[^:]+:\/*[^/]*$/;const z=/^([^:]+:)[\s\S]*$/;const S=/^([^:]+:\/*[^/]*)[\s\S]*$/;function A(t,e){if(!v[" "+t]){if(_.test(t)){v[" "+t]=t+"/"}else{v[" "+t]=Z(t,"/",true)}}t=v[" "+t];const n=t.indexOf(":")===-1;if(e.substring(0,2)==="//"){if(n){return e}return t.replace(z,"$1")+e}else if(e.charAt(0)==="/"){if(n){return e}return t.replace(S,"$1")+e}else{return t+e}}const E={exec:function t(){}};function I(t,e){const n=t.replace(/\|/g,((t,e,n)=>{let i=false,s=e;while(--s>=0&&n[s]==="\\")i=!i;if(i){return"|"}else{return" |"}})),i=n.split(/ \|/);let s=0;if(!i[0].trim()){i.shift()}if(i.length>0&&!i[i.length-1].trim()){i.pop()}if(i.length>e){i.splice(e)}else{while(i.length<e)i.push("")}for(;s<i.length;s++){i[s]=i[s].trim().replace(/\\\|/g,"|")}return i}function Z(t,e,n){const i=t.length;if(i===0){return""}let s=0;while(s<i){const r=t.charAt(i-s-1);if(r===e&&!n){s++}else if(r!==e&&n){s++}else{break}}return t.slice(0,i-s)}function C(t,e){if(t.indexOf(e[1])===-1){return-1}const n=t.length;let i=0,s=0;for(;s<n;s++){if(t[s]==="\\"){s++}else if(t[s]===e[0]){i++}else if(t[s]===e[1]){i--;if(i<0){return s}}}return-1}function q(t){if(t&&t.sanitize&&!t.silent){console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}}function j(t,e){if(e<1){return""}let n="";while(e>1){if(e&1){n+=t}e>>=1;t+=t}return n+t}function M(t,e,n,i){const s=e.href;const r=e.title?g(e.title):null;const o=t[1].replace(/\\([\[\]])/g,"$1");if(t[0].charAt(0)!=="!"){i.state.inLink=true;const t={type:"link",raw:n,href:s,title:r,text:o,tokens:i.inlineTokens(o)};i.state.inLink=false;return t}return{type:"image",raw:n,href:s,title:r,text:g(o)}}function T(t,e){const n=t.match(/^(\s+)(?:```)/);if(n===null){return e}const i=n[1];return e.split("\n").map((t=>{const e=t.match(/^\s+/);if(e===null){return t}const[n]=e;if(n.length>=i.length){return t.slice(i.length)}return t})).join("\n")}class R{constructor(t){this.options=t||a}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0){return{type:"space",raw:e[0]}}}code(t){const e=this.rules.block.code.exec(t);if(e){const t=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:!this.options.pedantic?Z(t,"\n"):t}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const t=e[0];const n=T(t,e[3]||"");return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline._escapes,"$1"):e[2],text:n}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let t=e[2].trim();if(/#$/.test(t)){const e=Z(t,"#");if(this.options.pedantic){t=e.trim()}else if(!e||/ $/.test(e)){t=e.trim()}}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e){return{type:"hr",raw:e[0]}}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){const t=e[0].replace(/^ *>[ \t]?/gm,"");const n=this.lexer.state.top;this.lexer.state.top=true;const i=this.lexer.blockTokens(t);this.lexer.state.top=n;return{type:"blockquote",raw:e[0],tokens:i,text:t}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n,i,s,r,o,a,l,c,h,d,f,u;let p=e[1].trim();const g=p.length>1;const b={type:"list",raw:"",ordered:g,start:g?+p.slice(0,-1):"",loose:false,items:[]};p=g?`\\d{1,9}\\${p.slice(-1)}`:`\\${p}`;if(this.options.pedantic){p=g?p:"[*+-]"}const m=new RegExp(`^( {0,3}${p})((?:[\t ][^\\n]*)?(?:\\n|$))`);while(t){u=false;if(!(e=m.exec(t))){break}if(this.rules.block.hr.test(t)){break}n=e[0];t=t.substring(n.length);c=e[2].split("\n",1)[0].replace(/^\t+/,(t=>" ".repeat(3*t.length)));h=t.split("\n",1)[0];if(this.options.pedantic){r=2;f=c.trimLeft()}else{r=e[2].search(/[^ ]/);r=r>4?1:r;f=c.slice(r);r+=e[1].length}a=false;if(!c&&/^ *$/.test(h)){n+=h+"\n";t=t.substring(h.length+1);u=true}if(!u){const e=new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`);const i=new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`);const s=new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`);const o=new RegExp(`^ {0,${Math.min(3,r-1)}}#`);while(t){d=t.split("\n",1)[0];h=d;if(this.options.pedantic){h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")}if(s.test(h)){break}if(o.test(h)){break}if(e.test(h)){break}if(i.test(t)){break}if(h.search(/[^ ]/)>=r||!h.trim()){f+="\n"+h.slice(r)}else{if(a){break}if(c.search(/[^ ]/)>=4){break}if(s.test(c)){break}if(o.test(c)){break}if(i.test(c)){break}f+="\n"+h}if(!a&&!h.trim()){a=true}n+=d+"\n";t=t.substring(d.length+1);c=h.slice(r)}}if(!b.loose){if(l){b.loose=true}else if(/\n *\n *$/.test(n)){l=true}}if(this.options.gfm){i=/^\[[ xX]\] /.exec(f);if(i){s=i[0]!=="[ ] ";f=f.replace(/^\[[ xX]\] +/,"")}}b.items.push({type:"list_item",raw:n,task:!!i,checked:s,loose:false,text:f});b.raw+=n}b.items[b.items.length-1].raw=n.trimRight();b.items[b.items.length-1].text=f.trimRight();b.raw=b.raw.trimRight();const x=b.items.length;for(o=0;o<x;o++){this.lexer.state.top=false;b.items[o].tokens=this.lexer.blockTokens(b.items[o].text,[]);if(!b.loose){const t=b.items[o].tokens.filter((t=>t.type==="space"));const e=t.length>0&&t.some((t=>/\n.*\n/.test(t.raw)));b.loose=e}}if(b.loose){for(o=0;o<x;o++){b.items[o].loose=true}}return b}}html(t){const e=this.rules.block.html.exec(t);if(e){const t={type:"html",raw:e[0],pre:!this.options.sanitizer&&(e[1]==="pre"||e[1]==="script"||e[1]==="style"),text:e[0]};if(this.options.sanitize){const n=this.options.sanitizer?this.options.sanitizer(e[0]):g(e[0]);t.type="paragraph";t.text=n;t.tokens=this.lexer.inline(n)}return t}}def(t){const e=this.rules.block.def.exec(t);if(e){const t=e[1].toLowerCase().replace(/\s+/g," ");const n=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"";const i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline._escapes,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:n,title:i}}}table(t){const e=this.rules.block.table.exec(t);if(e){const t={type:"table",header:I(e[1]).map((t=>({text:t}))),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(t.header.length===t.align.length){t.raw=e[0];let n=t.align.length;let i,s,r,o;for(i=0;i<n;i++){if(/^ *-+: *$/.test(t.align[i])){t.align[i]="right"}else if(/^ *:-+: *$/.test(t.align[i])){t.align[i]="center"}else if(/^ *:-+ *$/.test(t.align[i])){t.align[i]="left"}else{t.align[i]=null}}n=t.rows.length;for(i=0;i<n;i++){t.rows[i]=I(t.rows[i],t.header.length).map((t=>({text:t})))}n=t.header.length;for(s=0;s<n;s++){t.header[s].tokens=this.lexer.inline(t.header[s].text)}n=t.rows.length;for(s=0;s<n;s++){o=t.rows[s];for(r=0;r<o.length;r++){o[r].tokens=this.lexer.inline(o[r].text)}}return t}}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e){return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const t=e[1].charAt(e[1].length-1)==="\n"?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(t){const e=this.rules.block.text.exec(t);if(e){return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}}escape(t){const e=this.rules.inline.escape.exec(t);if(e){return{type:"escape",raw:e[0],text:g(e[1])}}}tag(t){const e=this.rules.inline.tag.exec(t);if(e){if(!this.lexer.state.inLink&&/^<a /i.test(e[0])){this.lexer.state.inLink=true}else if(this.lexer.state.inLink&&/^<\/a>/i.test(e[0])){this.lexer.state.inLink=false}if(!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])){this.lexer.state.inRawBlock=true}else if(this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])){this.lexer.state.inRawBlock=false}return{type:this.options.sanitize?"text":"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):g(e[0]):e[0]}}}link(t){const e=this.rules.inline.link.exec(t);if(e){const t=e[2].trim();if(!this.options.pedantic&&/^</.test(t)){if(!/>$/.test(t)){return}const e=Z(t.slice(0,-1),"\\");if((t.length-e.length)%2===0){return}}else{const t=C(e[2],"()");if(t>-1){const n=e[0].indexOf("!")===0?5:4;const i=n+e[1].length+t;e[2]=e[2].substring(0,t);e[0]=e[0].substring(0,i).trim();e[3]=""}}let n=e[2];let i="";if(this.options.pedantic){const t=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);if(t){n=t[1];i=t[3]}}else{i=e[3]?e[3].slice(1,-1):""}n=n.trim();if(/^</.test(n)){if(this.options.pedantic&&!/>$/.test(t)){n=n.slice(1)}else{n=n.slice(1,-1)}}return M(e,{href:n?n.replace(this.rules.inline._escapes,"$1"):n,title:i?i.replace(this.rules.inline._escapes,"$1"):i},e[0],this.lexer)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let t=(n[2]||n[1]).replace(/\s+/g," ");t=e[t.toLowerCase()];if(!t){const t=n[0].charAt(0);return{type:"text",raw:t,text:t}}return M(n,t,n[0],this.lexer)}}emStrong(t,e,n=""){let i=this.rules.inline.emStrong.lDelim.exec(t);if(!i)return;if(i[3]&&n.match(/[\p{L}\p{N}]/u))return;const s=i[1]||i[2]||"";if(!s||s&&(n===""||this.rules.inline.punctuation.exec(n))){const n=i[0].length-1;let s,r,o=n,a=0;const l=i[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;l.lastIndex=0;e=e.slice(-1*t.length+n);while((i=l.exec(e))!=null){s=i[1]||i[2]||i[3]||i[4]||i[5]||i[6];if(!s)continue;r=s.length;if(i[3]||i[4]){o+=r;continue}else if(i[5]||i[6]){if(n%3&&!((n+r)%3)){a+=r;continue}}o-=r;if(o>0)continue;r=Math.min(r,r+o+a);const e=t.slice(0,n+i.index+(i[0].length-s.length)+r);if(Math.min(n,r)%2){const t=e.slice(1,-1);return{type:"em",raw:e,text:t,tokens:this.lexer.inlineTokens(t)}}const l=e.slice(2,-2);return{type:"strong",raw:e,text:l,tokens:this.lexer.inlineTokens(l)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let t=e[2].replace(/\n/g," ");const n=/[^ ]/.test(t);const i=/^ /.test(t)&&/ $/.test(t);if(n&&i){t=t.substring(1,t.length-1)}t=g(t,true);return{type:"codespan",raw:e[0],text:t}}}br(t){const e=this.rules.inline.br.exec(t);if(e){return{type:"br",raw:e[0]}}}del(t){const e=this.rules.inline.del.exec(t);if(e){return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}}autolink(t,e){const n=this.rules.inline.autolink.exec(t);if(n){let t,i;if(n[2]==="@"){t=g(this.options.mangle?e(n[1]):n[1]);i="mailto:"+t}else{t=g(n[1]);i=t}return{type:"link",raw:n[0],text:t,href:i,tokens:[{type:"text",raw:t,text:t}]}}}url(t,e){let n;if(n=this.rules.inline.url.exec(t)){let t,i;if(n[2]==="@"){t=g(this.options.mangle?e(n[0]):n[0]);i="mailto:"+t}else{let e;do{e=n[0];n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(e!==n[0]);t=g(n[0]);if(n[1]==="www."){i="http://"+n[0]}else{i=n[0]}}return{type:"link",raw:n[0],text:t,href:i,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(t,e){const n=this.rules.inline.text.exec(t);if(n){let t;if(this.lexer.state.inRawBlock){t=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):g(n[0]):n[0]}else{t=g(this.options.smartypants?e(n[0]):n[0])}return{type:"text",raw:n[0],text:t}}}}const P={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:"+"<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)"+"|comment[^\\n]*(\\n+|$)"+"|<\\?[\\s\\S]*?(?:\\?>\\n*|$)"+"|<![A-Z][\\s\\S]*?(?:>\\n*|$)"+"|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)"+"|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)"+"|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)"+"|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)"+")",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:E,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};P._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;P._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;P.def=k(P.def).replace("label",P._label).replace("title",P._title).getRegex();P.bullet=/(?:[*+-]|\d{1,9}[.)])/;P.listItemStart=k(/^( *)(bull) */).replace("bull",P.bullet).getRegex();P.list=k(P.list).replace(/bull/g,P.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+P.def.source+")").getRegex();P._tag="address|article|aside|base|basefont|blockquote|body|caption"+"|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption"+"|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe"+"|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option"+"|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr"+"|track|ul";P._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;P.html=k(P.html,"i").replace("comment",P._comment).replace("tag",P._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();P.paragraph=k(P._paragraph).replace("hr",P.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",P._tag).getRegex();P.blockquote=k(P.blockquote).replace("paragraph",P.paragraph).getRegex();P.normal={...P};P.gfm={...P.normal,table:"^ *([^\\n ].*\\|.*)\\n"+" {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?"+"(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};P.gfm.table=k(P.gfm.table).replace("hr",P.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",P._tag).getRegex();P.gfm.paragraph=k(P._paragraph).replace("hr",P.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",P.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",P._tag).getRegex();P.pedantic={...P.normal,html:k("^ *(?:comment *(?:\\n|\\s*$)"+"|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)"+"|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",P._comment).replace(/tag/g,"(?!(?:"+"a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub"+"|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)"+"\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:E,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:k(P.normal._paragraph).replace("hr",P.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",P.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const D={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:E,tag:"^comment"+"|^</[a-zA-Z][\\w:-]*\\s*>"+"|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>"+"|^<\\?[\\s\\S]*?\\?>"+"|^<![a-zA-Z]+\\s[\\s\\S]*?>"+"|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:E,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};D._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";D.punctuation=k(D.punctuation).replace(/punctuation/g,D._punctuation).getRegex();D.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;D.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;D._comment=k(P._comment).replace("(?:--\x3e|$)","--\x3e").getRegex();D.emStrong.lDelim=k(D.emStrong.lDelim).replace(/punct/g,D._punctuation).getRegex();D.emStrong.rDelimAst=k(D.emStrong.rDelimAst,"g").replace(/punct/g,D._punctuation).getRegex();D.emStrong.rDelimUnd=k(D.emStrong.rDelimUnd,"g").replace(/punct/g,D._punctuation).getRegex();D._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;D._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;D._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;D.autolink=k(D.autolink).replace("scheme",D._scheme).replace("email",D._email).getRegex();D._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;D.tag=k(D.tag).replace("comment",D._comment).replace("attribute",D._attribute).getRegex();D._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;D._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;D._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;D.link=k(D.link).replace("label",D._label).replace("href",D._href).replace("title",D._title).getRegex();D.reflink=k(D.reflink).replace("label",D._label).replace("ref",P._label).getRegex();D.nolink=k(D.nolink).replace("ref",P._label).getRegex();D.reflinkSearch=k(D.reflinkSearch,"g").replace("reflink",D.reflink).replace("nolink",D.nolink).getRegex();D.normal={...D};D.pedantic={...D.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:k(/^!?\[(label)\]\((.*?)\)/).replace("label",D._label).getRegex(),reflink:k(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",D._label).getRegex()};D.gfm={...D.normal,escape:k(D.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};D.gfm.url=k(D.gfm.url,"i").replace("email",D.gfm._extended_email).getRegex();D.breaks={...D.gfm,br:k(D.br).replace("{2,}","*").getRegex(),text:k(D.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function L(t){return t.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function N(t){let e="",n,i;const s=t.length;for(n=0;n<s;n++){i=t.charCodeAt(n);if(Math.random()>.5){i="x"+i.toString(16)}e+="&#"+i+";"}return e}class O{constructor(t){this.tokens=[];this.tokens.links=Object.create(null);this.options=t||a;this.options.tokenizer=this.options.tokenizer||new R;this.tokenizer=this.options.tokenizer;this.tokenizer.options=this.options;this.tokenizer.lexer=this;this.inlineQueue=[];this.state={inLink:false,inRawBlock:false,top:true};const e={block:P.normal,inline:D.normal};if(this.options.pedantic){e.block=P.pedantic;e.inline=D.pedantic}else if(this.options.gfm){e.block=P.gfm;if(this.options.breaks){e.inline=D.breaks}else{e.inline=D.gfm}}this.tokenizer.rules=e}static get rules(){return{block:P,inline:D}}static lex(t,e){const n=new O(e);return n.lex(t)}static lexInline(t,e){const n=new O(e);return n.inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,"\n");this.blockTokens(t,this.tokens);let e;while(e=this.inlineQueue.shift()){this.inlineTokens(e.src,e.tokens)}return this.tokens}blockTokens(t,e=[]){if(this.options.pedantic){t=t.replace(/\t/g,"    ").replace(/^ +$/gm,"")}else{t=t.replace(/^( *)(\t+)/gm,((t,e,n)=>e+"    ".repeat(n.length)))}let n,i,s,r;while(t){if(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((i=>{if(n=i.call({lexer:this},t,e)){t=t.substring(n.raw.length);e.push(n);return true}return false}))){continue}if(n=this.tokenizer.space(t)){t=t.substring(n.raw.length);if(n.raw.length===1&&e.length>0){e[e.length-1].raw+="\n"}else{e.push(n)}continue}if(n=this.tokenizer.code(t)){t=t.substring(n.raw.length);i=e[e.length-1];if(i&&(i.type==="paragraph"||i.type==="text")){i.raw+="\n"+n.raw;i.text+="\n"+n.text;this.inlineQueue[this.inlineQueue.length-1].src=i.text}else{e.push(n)}continue}if(n=this.tokenizer.fences(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.heading(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.hr(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.blockquote(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.list(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.html(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.def(t)){t=t.substring(n.raw.length);i=e[e.length-1];if(i&&(i.type==="paragraph"||i.type==="text")){i.raw+="\n"+n.raw;i.text+="\n"+n.raw;this.inlineQueue[this.inlineQueue.length-1].src=i.text}else if(!this.tokens.links[n.tag]){this.tokens.links[n.tag]={href:n.href,title:n.title}}continue}if(n=this.tokenizer.table(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.lheading(t)){t=t.substring(n.raw.length);e.push(n);continue}s=t;if(this.options.extensions&&this.options.extensions.startBlock){let e=Infinity;const n=t.slice(1);let i;this.options.extensions.startBlock.forEach((function(t){i=t.call({lexer:this},n);if(typeof i==="number"&&i>=0){e=Math.min(e,i)}}));if(e<Infinity&&e>=0){s=t.substring(0,e+1)}}if(this.state.top&&(n=this.tokenizer.paragraph(s))){i=e[e.length-1];if(r&&i.type==="paragraph"){i.raw+="\n"+n.raw;i.text+="\n"+n.text;this.inlineQueue.pop();this.inlineQueue[this.inlineQueue.length-1].src=i.text}else{e.push(n)}r=s.length!==t.length;t=t.substring(n.raw.length);continue}if(n=this.tokenizer.text(t)){t=t.substring(n.raw.length);i=e[e.length-1];if(i&&i.type==="text"){i.raw+="\n"+n.raw;i.text+="\n"+n.text;this.inlineQueue.pop();this.inlineQueue[this.inlineQueue.length-1].src=i.text}else{e.push(n)}continue}if(t){const e="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(e);break}else{throw new Error(e)}}}this.state.top=true;return e}inline(t,e=[]){this.inlineQueue.push({src:t,tokens:e});return e}inlineTokens(t,e=[]){let n,i,s;let r=t;let o;let a,l;if(this.tokens.links){const t=Object.keys(this.tokens.links);if(t.length>0){while((o=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null){if(t.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))){r=r.slice(0,o.index)+"["+j("a",o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex)}}}}while((o=this.tokenizer.rules.inline.blockSkip.exec(r))!=null){r=r.slice(0,o.index)+"["+j("a",o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex)}while((o=this.tokenizer.rules.inline.escapedEmSt.exec(r))!=null){r=r.slice(0,o.index+o[0].length-2)+"++"+r.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);this.tokenizer.rules.inline.escapedEmSt.lastIndex--}while(t){if(!a){l=""}a=false;if(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((i=>{if(n=i.call({lexer:this},t,e)){t=t.substring(n.raw.length);e.push(n);return true}return false}))){continue}if(n=this.tokenizer.escape(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.tag(t)){t=t.substring(n.raw.length);i=e[e.length-1];if(i&&n.type==="text"&&i.type==="text"){i.raw+=n.raw;i.text+=n.text}else{e.push(n)}continue}if(n=this.tokenizer.link(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(n.raw.length);i=e[e.length-1];if(i&&n.type==="text"&&i.type==="text"){i.raw+=n.raw;i.text+=n.text}else{e.push(n)}continue}if(n=this.tokenizer.emStrong(t,r,l)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.codespan(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.br(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.del(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.autolink(t,N)){t=t.substring(n.raw.length);e.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(t,N))){t=t.substring(n.raw.length);e.push(n);continue}s=t;if(this.options.extensions&&this.options.extensions.startInline){let e=Infinity;const n=t.slice(1);let i;this.options.extensions.startInline.forEach((function(t){i=t.call({lexer:this},n);if(typeof i==="number"&&i>=0){e=Math.min(e,i)}}));if(e<Infinity&&e>=0){s=t.substring(0,e+1)}}if(n=this.tokenizer.inlineText(s,L)){t=t.substring(n.raw.length);if(n.raw.slice(-1)!=="_"){l=n.raw.slice(-1)}a=true;i=e[e.length-1];if(i&&i.type==="text"){i.raw+=n.raw;i.text+=n.text}else{e.push(n)}continue}if(t){const e="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(e);break}else{throw new Error(e)}}}return e}}class F{constructor(t){this.options=t||a}code(t,e,n){const i=(e||"").match(/\S*/)[0];if(this.options.highlight){const e=this.options.highlight(t,i);if(e!=null&&e!==t){n=true;t=e}}t=t.replace(/\n$/,"")+"\n";if(!i){return"<pre><code>"+(n?t:g(t,true))+"</code></pre>\n"}return'<pre><code class="'+this.options.langPrefix+g(i)+'">'+(n?t:g(t,true))+"</code></pre>\n"}blockquote(t){return`<blockquote>\n${t}</blockquote>\n`}html(t){return t}heading(t,e,n,i){if(this.options.headerIds){const s=this.options.headerPrefix+i.slug(n);return`<h${e} id="${s}">${t}</h${e}>\n`}return`<h${e}>${t}</h${e}>\n`}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(t,e,n){const i=e?"ol":"ul",s=e&&n!==1?' start="'+n+'"':"";return"<"+i+s+">\n"+t+"</"+i+">\n"}listitem(t){return`<li>${t}</li>\n`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return`<p>${t}</p>\n`}table(t,e){if(e)e=`<tbody>${e}</tbody>`;return"<table>\n"+"<thead>\n"+t+"</thead>\n"+e+"</table>\n"}tablerow(t){return`<tr>\n${t}</tr>\n`}tablecell(t,e){const n=e.header?"th":"td";const i=e.align?`<${n} align="${e.align}">`:`<${n}>`;return i+t+`</${n}>\n`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return`<del>${t}</del>`}link(t,e,n){t=$(this.options.sanitize,this.options.baseUrl,t);if(t===null){return n}let i='<a href="'+t+'"';if(e){i+=' title="'+e+'"'}i+=">"+n+"</a>";return i}image(t,e,n){t=$(this.options.sanitize,this.options.baseUrl,t);if(t===null){return n}let i=`<img src="${t}" alt="${n}"`;if(e){i+=` title="${e}"`}i+=this.options.xhtml?"/>":">";return i}text(t){return t}}class U{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,e,n){return""+n}image(t,e,n){return""+n}br(){return""}}class X{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,e){let n=t;let i=0;if(this.seen.hasOwnProperty(n)){i=this.seen[t];do{i++;n=t+"-"+i}while(this.seen.hasOwnProperty(n))}if(!e){this.seen[t]=i;this.seen[n]=0}return n}slug(t,e={}){const n=this.serialize(t);return this.getNextSafeSlug(n,e.dryrun)}}class Y{constructor(t){this.options=t||a;this.options.renderer=this.options.renderer||new F;this.renderer=this.options.renderer;this.renderer.options=this.options;this.textRenderer=new U;this.slugger=new X}static parse(t,e){const n=new Y(e);return n.parse(t)}static parseInline(t,e){const n=new Y(e);return n.parseInline(t)}parse(t,e=true){let n="",i,s,r,o,a,l,c,h,d,f,u,p,g,b,x,k,w,y,$;const v=t.length;for(i=0;i<v;i++){f=t[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[f.type]){$=this.options.extensions.renderers[f.type].call({parser:this},f);if($!==false||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(f.type)){n+=$||"";continue}}switch(f.type){case"space":{continue}case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(f.tokens),f.depth,m(this.parseInline(f.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(f.text,f.lang,f.escaped);continue}case"table":{h="";c="";o=f.header.length;for(s=0;s<o;s++){c+=this.renderer.tablecell(this.parseInline(f.header[s].tokens),{header:true,align:f.align[s]})}h+=this.renderer.tablerow(c);d="";o=f.rows.length;for(s=0;s<o;s++){l=f.rows[s];c="";a=l.length;for(r=0;r<a;r++){c+=this.renderer.tablecell(this.parseInline(l[r].tokens),{header:false,align:f.align[r]})}d+=this.renderer.tablerow(c)}n+=this.renderer.table(h,d);continue}case"blockquote":{d=this.parse(f.tokens);n+=this.renderer.blockquote(d);continue}case"list":{u=f.ordered;p=f.start;g=f.loose;o=f.items.length;d="";for(s=0;s<o;s++){x=f.items[s];k=x.checked;w=x.task;b="";if(x.task){y=this.renderer.checkbox(k);if(g){if(x.tokens.length>0&&x.tokens[0].type==="paragraph"){x.tokens[0].text=y+" "+x.tokens[0].text;if(x.tokens[0].tokens&&x.tokens[0].tokens.length>0&&x.tokens[0].tokens[0].type==="text"){x.tokens[0].tokens[0].text=y+" "+x.tokens[0].tokens[0].text}}else{x.tokens.unshift({type:"text",text:y})}}else{b+=y}}b+=this.parse(x.tokens,g);d+=this.renderer.listitem(b,w,k)}n+=this.renderer.list(d,u,p);continue}case"html":{n+=this.renderer.html(f.text);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(f.tokens));continue}case"text":{d=f.tokens?this.parseInline(f.tokens):f.text;while(i+1<v&&t[i+1].type==="text"){f=t[++i];d+="\n"+(f.tokens?this.parseInline(f.tokens):f.text)}n+=e?this.renderer.paragraph(d):d;continue}default:{const t='Token with "'+f.type+'" type was not found.';if(this.options.silent){console.error(t);return}else{throw new Error(t)}}}}return n}parseInline(t,e){e=e||this.renderer;let n="",i,s,r;const o=t.length;for(i=0;i<o;i++){s=t[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){r=this.options.extensions.renderers[s.type].call({parser:this},s);if(r!==false||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=r||"";continue}}switch(s.type){case"escape":{n+=e.text(s.text);break}case"html":{n+=e.html(s.text);break}case"link":{n+=e.link(s.href,s.title,this.parseInline(s.tokens,e));break}case"image":{n+=e.image(s.href,s.title,s.text);break}case"strong":{n+=e.strong(this.parseInline(s.tokens,e));break}case"em":{n+=e.em(this.parseInline(s.tokens,e));break}case"codespan":{n+=e.codespan(s.text);break}case"br":{n+=e.br();break}case"del":{n+=e.del(this.parseInline(s.tokens,e));break}case"text":{n+=e.text(s.text);break}default:{const t='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(t);return}else{throw new Error(t)}}}}return n}}class B{constructor(t){this.options=t||a}static passThroughHooks=new Set(["preprocess","postprocess"]);preprocess(t){return t}postprocess(t){return t}}function G(t,e,n){return i=>{i.message+="\nPlease report this to https://github.com/markedjs/marked.";if(t){const t="<p>An error occurred:</p><pre>"+g(i.message+"",true)+"</pre>";if(e){return Promise.resolve(t)}if(n){n(null,t);return}return t}if(e){return Promise.reject(i)}if(n){n(i);return}throw i}}function H(t,e){return(n,i,s)=>{if(typeof i==="function"){s=i;i=null}const r={...i};i={...J.defaults,...r};const o=G(i.silent,i.async,s);if(typeof n==="undefined"||n===null){return o(new Error("marked(): input parameter is undefined or null"))}if(typeof n!=="string"){return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"))}q(i);if(i.hooks){i.hooks.options=i}if(s){const r=i.highlight;let a;try{if(i.hooks){n=i.hooks.preprocess(n)}a=t(n,i)}catch(t){return o(t)}const l=function(t){let n;if(!t){try{if(i.walkTokens){J.walkTokens(a,i.walkTokens)}n=e(a,i);if(i.hooks){n=i.hooks.postprocess(n)}}catch(e){t=e}}i.highlight=r;return t?o(t):s(null,n)};if(!r||r.length<3){return l()}delete i.highlight;if(!a.length)return l();let c=0;J.walkTokens(a,(function(t){if(t.type==="code"){c++;setTimeout((()=>{r(t.text,t.lang,(function(e,n){if(e){return l(e)}if(n!=null&&n!==t.text){t.text=n;t.escaped=true}c--;if(c===0){l()}}))}),0)}}));if(c===0){l()}return}if(i.async){return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then((e=>t(e,i))).then((t=>i.walkTokens?Promise.all(J.walkTokens(t,i.walkTokens)).then((()=>t)):t)).then((t=>e(t,i))).then((t=>i.hooks?i.hooks.postprocess(t):t)).catch(o)}try{if(i.hooks){n=i.hooks.preprocess(n)}const s=t(n,i);if(i.walkTokens){J.walkTokens(s,i.walkTokens)}let r=e(s,i);if(i.hooks){r=i.hooks.postprocess(r)}return r}catch(t){return o(t)}}}function J(t,e,n){return H(O.lex,Y.parse)(t,e,n)}J.options=J.setOptions=function(t){J.defaults={...J.defaults,...t};l(J.defaults);return J};J.getDefaults=o;J.defaults=a;J.use=function(...t){const e=J.defaults.extensions||{renderers:{},childTokens:{}};t.forEach((t=>{const n={...t};n.async=J.defaults.async||n.async||false;if(t.extensions){t.extensions.forEach((t=>{if(!t.name){throw new Error("extension name required")}if(t.renderer){const n=e.renderers[t.name];if(n){e.renderers[t.name]=function(...e){let i=t.renderer.apply(this,e);if(i===false){i=n.apply(this,e)}return i}}else{e.renderers[t.name]=t.renderer}}if(t.tokenizer){if(!t.level||t.level!=="block"&&t.level!=="inline"){throw new Error("extension level must be 'block' or 'inline'")}if(e[t.level]){e[t.level].unshift(t.tokenizer)}else{e[t.level]=[t.tokenizer]}if(t.start){if(t.level==="block"){if(e.startBlock){e.startBlock.push(t.start)}else{e.startBlock=[t.start]}}else if(t.level==="inline"){if(e.startInline){e.startInline.push(t.start)}else{e.startInline=[t.start]}}}}if(t.childTokens){e.childTokens[t.name]=t.childTokens}}));n.extensions=e}if(t.renderer){const e=J.defaults.renderer||new F;for(const n in t.renderer){const i=e[n];e[n]=(...s)=>{let r=t.renderer[n].apply(e,s);if(r===false){r=i.apply(e,s)}return r}}n.renderer=e}if(t.tokenizer){const e=J.defaults.tokenizer||new R;for(const n in t.tokenizer){const i=e[n];e[n]=(...s)=>{let r=t.tokenizer[n].apply(e,s);if(r===false){r=i.apply(e,s)}return r}}n.tokenizer=e}if(t.hooks){const e=J.defaults.hooks||new B;for(const n in t.hooks){const i=e[n];if(B.passThroughHooks.has(n)){e[n]=s=>{if(J.defaults.async){return Promise.resolve(t.hooks[n].call(e,s)).then((t=>i.call(e,t)))}const r=t.hooks[n].call(e,s);return i.call(e,r)}}else{e[n]=(...s)=>{let r=t.hooks[n].apply(e,s);if(r===false){r=i.apply(e,s)}return r}}}n.hooks=e}if(t.walkTokens){const e=J.defaults.walkTokens;n.walkTokens=function(n){let i=[];i.push(t.walkTokens.call(this,n));if(e){i=i.concat(e.call(this,n))}return i}}J.setOptions(n)}))};J.walkTokens=function(t,e){let n=[];for(const i of t){n=n.concat(e.call(J,i));switch(i.type){case"table":{for(const t of i.header){n=n.concat(J.walkTokens(t.tokens,e))}for(const t of i.rows){for(const i of t){n=n.concat(J.walkTokens(i.tokens,e))}}break}case"list":{n=n.concat(J.walkTokens(i.items,e));break}default:{if(J.defaults.extensions&&J.defaults.extensions.childTokens&&J.defaults.extensions.childTokens[i.type]){J.defaults.extensions.childTokens[i.type].forEach((function(t){n=n.concat(J.walkTokens(i[t],e))}))}else if(i.tokens){n=n.concat(J.walkTokens(i.tokens,e))}}}}return n};J.parseInline=H(O.lexInline,Y.parseInline);J.Parser=Y;J.parser=Y.parse;J.Renderer=F;J.TextRenderer=U;J.Lexer=O;J.lexer=O.lex;J.Tokenizer=R;J.Slugger=X;J.Hooks=B;J.parse=J;const Q=":host{font-family:'Yantramanav', serif, Arial, sans-serif;line-height:1.5;font-weight:400;--main-color:#ff8834}p{all:unset}button{font-family:'Signika', serif, Arial, sans-serif}input{font-family:'Yantramanav', serif, Arial, sans-serif}.modal-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:rgba(0, 0, 0, 0.5);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;visibility:hidden;transition:opacity 0.3s ease, visibility 0.3s ease}.modal-overlay.visible{opacity:1;visibility:visible}.chat-container{width:90vw;height:90vh;max-width:1200px;max-height:800px;background:white;border-radius:12px;display:flex;flex-direction:column;box-shadow:0 20px 60px rgba(0, 0, 0, 0.3);position:relative;transform:scale(0.8);transition:transform 0.3s ease}.modal-overlay.visible .chat-container{transform:scale(1)}.modal-header{display:flex;justify-content:space-between;align-items:center;padding:20px 30px;border-bottom:1px solid #eee;background:linear-gradient(135deg, var(--main-color), #ff8834);color:white;border-radius:12px 12px 0 0}.modal-title{font-family:'Signika', Arial, sans-serif;font-size:1.25rem;font-weight:600;margin:0}.close-button{background:none;border:none;color:white;font-size:1.5rem;cursor:pointer;padding:8px;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;transition:background-color 0.2s ease}.close-button:hover{background-color:rgba(255, 255, 255, 0.2)}.chat-content{flex:1;display:flex;flex-direction:column;padding:30px;min-height:0}.message-container{flex:1;overflow-y:auto;margin-bottom:20px;padding:20px;border:1px solid #eee;border-radius:8px;min-height:300px}.message{margin:12px 0;padding:12px 16px;border-radius:12px;max-width:80%;word-wrap:break-word;line-height:1.4}.user-message{background:linear-gradient(135deg, var(--main-color), #ff8834);color:white;margin-left:auto;width:fit-content;border-radius:20px 20px 0px 20px}.ai-message{background:hsla(240, 6%, 90%, 0.5);color:#333;margin-right:auto;width:fit-content;border-radius:20px 20px 20px 0px}.input-container{display:flex;gap:12px;align-items:center;background:white;padding:16px;border:1px solid #ddd;border-radius:8px;box-shadow:0 2px 8px rgba(0, 0, 0, 0.1)}input{flex:1;padding:12px 16px;border:1px solid #ddd;border-radius:6px;font-size:1rem;outline:none;transition:border-color 0.2s ease}input:focus{border-color:var(--main-color);box-shadow:0 0 0 2px rgba(236, 102, 7, 0.1)}button{padding:12px 24px;background:linear-gradient(135deg, var(--main-color), #ff8834);color:white;border:none;border-radius:6px;cursor:pointer;font-size:1rem;font-weight:600;transition:transform 0.2s ease, box-shadow 0.2s ease}button:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px rgba(236, 102, 7, 0.3)}button:disabled{background:#cccccc;cursor:not-allowed;transform:none;box-shadow:none}.typing-indicator{display:none;margin:12px 0;max-width:80%;margin-right:auto}.typing-indicator.active{display:block}.typing-indicator .skeleton-container{margin:0;background:transparent;border:none;padding:12px 16px}.typing-indicator .skeleton-wrapper{gap:8px}.typing-indicator .skeleton-avatar{width:24px;height:24px;margin-bottom:0}.typing-indicator .skeleton-line{height:12px}.typing-indicator .skeleton-typing{margin-top:4px}.message-container::-webkit-scrollbar{width:8px}.message-container::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.message-container::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.message-container::-webkit-scrollbar-thumb:hover{background:#a1a1a1}@media (max-width: 768px){.chat-container{width:95vw;height:95vh;border-radius:8px}.modal-header{padding:15px 20px}.modal-title{font-size:1.25rem}.chat-content{padding:20px}.message{max-width:90%;padding:10px 12px}.input-container{padding:12px;gap:8px}input{padding:10px 12px}button{padding:10px 16px}}.ai-feedback-buttons{display:flex;gap:8px;margin-top:8px;align-items:center}.ai-feedback-buttons button{all:unset;cursor:pointer}.ai-feedback-buttons button:hover{all:unset;cursor:pointer}.markdown-content{line-height:1.6;color:inherit}.markdown-content h1,.markdown-content h2,.markdown-content h3,.markdown-content h4,.markdown-content h5,.markdown-content h6{margin:16px 0 8px 0;font-weight:600;line-height:1.3}.markdown-content h1{font-size:1.5em}.markdown-content h2{font-size:1.4em}.markdown-content h3{font-size:1.3em}.markdown-content h4{font-size:1.2em}.markdown-content h5{font-size:1.1em}.markdown-content h6{font-size:1em}.markdown-content p{margin:8px 0;line-height:1.6}.markdown-content ul,.markdown-content ol{margin:8px 0;padding-left:24px}.markdown-content li{margin:4px 0;line-height:1.5}.markdown-content blockquote{margin:12px 0;padding:8px 16px;border-left:4px solid var(--main-color);background-color:rgba(255, 136, 52, 0.1);border-radius:4px;font-style:italic}.markdown-content code{background-color:rgba(0, 0, 0, 0.1);padding:2px 6px;border-radius:3px;font-family:'Monaco', 'Menlo', 'Ubuntu Mono', monospace;font-size:0.9em}.markdown-content pre{background-color:rgba(0, 0, 0, 0.1);padding:12px;border-radius:6px;overflow-x:auto;margin:12px 0}.markdown-content pre code{background:none;padding:0;border-radius:0}.markdown-content strong{font-weight:600}.markdown-content em{font-style:italic}.markdown-content a{color:var(--main-color);text-decoration:none}.markdown-content a:hover{text-decoration:underline}.markdown-content table{border-collapse:collapse;width:100%;margin:12px 0}.markdown-content th,.markdown-content td{border:1px solid #ddd;padding:8px 12px;text-align:left}.markdown-content th{background-color:rgba(255, 136, 52, 0.1);font-weight:600}.markdown-content hr{border:none;border-top:1px solid #ddd;margin:16px 0}.thumb-up,.thumb-down{width:16px;height:16px}@keyframes shimmer{0%{background-position:-200px 0}100%{background-position:calc(200px + 100%) 0}}.skeleton-container{position:relative}.skeleton-line{height:14px;background:linear-gradient(90deg, #e9ecef 25%, #f8f9fa 50%, #e9ecef 75%);background-size:200px 100%;animation:shimmer 1.5s infinite linear;border-radius:4px;margin-bottom:8px;position:relative;overflow:hidden}.skeleton-line:last-child{margin-bottom:0}.skeleton-line.line-1{width:95%}.skeleton-line.line-2{width:88%}.skeleton-line.line-3{width:72%}.skeleton-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(90deg, #e9ecef 25%, #f8f9fa 50%, #e9ecef 75%);background-size:200px 100%;animation:shimmer 1.5s infinite linear;margin-bottom:12px;display:inline-block}.skeleton-wrapper{display:flex;align-items:flex-start;gap:12px}.skeleton-content{flex:1}.skeleton-typing{display:flex;align-items:center;gap:4px;margin-top:8px}.skeleton-dot{width:6px;height:6px;border-radius:50%;background-color:#6c757d;animation:typing 1.4s infinite ease-in-out}.skeleton-dot:nth-child(1){animation-delay:-0.32s}.skeleton-dot:nth-child(2){animation-delay:-0.16s}.skeleton-dot:nth-child(3){animation-delay:0s}@keyframes typing{0%,80%,100%{opacity:0.3;transform:scale(0.8)}40%{opacity:1;transform:scale(1)}}.skeleton-glow{position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);animation:glow 2s infinite;border-radius:inherit}@keyframes glow{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}";const V=class{constructor(e){t(this,e)}open=true;modalTitle="Que puis-je faire pour vous ?";titleStyle={};messages=[];isLoading=false;iconSize=16;apiEndpoint=e.API_URL;conversationId="";componentWillLoad(){this.conversationId=s();console.log("Generated conversation ID:",this.conversationId);this.loadFonts();J.setOptions({breaks:true,gfm:true})}loadFonts(){const t=document.querySelector('link[href*="fonts.googleapis.com/css2?family=Signika"]');if(!t){const t=document.createElement("link");t.rel="stylesheet";t.href="https://fonts.googleapis.com/css2?family=Signika:wght@300..700&family=Yantramanav:wght@100;300;400;500;700;900&display=swap";document.head.appendChild(t)}}closeModal=()=>{this.open=false};handleChunk=async t=>{try{const e=this.messages.length-1;await r(t,this.apiEndpoint,this.conversationId,(t=>{this.messages=this.messages.map(((n,i)=>i===e?{...n,content:n.content+t}:n))}),(()=>{this.messages=this.messages.map(((t,n)=>n===e?{...t,isComplete:true}:t));this.isLoading=false}),(t=>{console.error("AI stream error:",t);this.messages=this.messages.map(((t,n)=>n===e?{...t,content:"Sorry, I encountered an error. Please try again.",isComplete:true}:t));this.isLoading=false}))}catch(t){console.error("Failed to call AI stream:",t);const e=this.messages.length-1;this.messages=this.messages.map(((t,n)=>n===e?{...t,content:"Sorry, I encountered an error. Please try again.",isComplete:true}:t));this.isLoading=false}};handleSubmit=async t=>{t.preventDefault();const e=t.target;const n=e.querySelector('input[name="message"]');const i=n.value;this.messages.push({role:"user",content:i});this.isLoading=true;e.reset();this.messages.push({role:"ai",content:""});await this.handleChunk(i)};renderMarkdown(t){try{const e=t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"");const n=J(e);if(typeof n==="string"){return n}else{return e}}catch(e){console.error("Error parsing markdown:",e);return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}}render(){return n(i,{key:"b7d9d1e5c132bc3c4bc8473c666bd3f288e975a0"},n("div",{key:"275795bd74b3ff75c78f3932407f297dcb834147",class:{"modal-overlay":true,visible:this.open}},n("div",{key:"5f8189c96bbaa993776751048e90ea864a63b962",class:"chat-container"},n("div",{key:"8a2cf0d7d545ce0d1290edc92f4b377617bafda3",class:"modal-header"},n("span",{key:"58e22a24be59f79b24b6e4fe5e764e8b388d0b3e",class:"modal-title"},this.modalTitle),n("button",{key:"3a2353e67602c96f88a72b861562aec88cd88cb6",class:"close-button",onClick:this.closeModal,"aria-label":"Close"},"×")),n("div",{key:"f4f51c6d6fb036647d7472206b2e617f299e9f92",class:"chat-content"},n("div",{key:"92097f54ee3197c3b255ba4d11eff0cad1bee0c0",class:"message-container"},this.messages.map(((t,e)=>n("div",{key:e,class:{message:true,"user-message":t.role==="user","ai-message":t.role==="ai"}},t.role==="ai"?n(n.Fragment,null,this.isLoading&&t.content===""?n("chat-skeleton",null):n("div",{class:"markdown-content",innerHTML:this.renderMarkdown(t.content)}),t.isComplete&&n("satisfaction-buttons",null)):n("p",null,t.content))))),n("form",{key:"17970a04f99dc7f2113f0bed6fcd471d031ad635",class:"input-container",onSubmit:this.handleSubmit},n("input",{key:"43726ba8ad324de5cf932774a2a30b4334d45bb4",name:"message",type:"text",placeholder:"Tapez votre message ici...",disabled:this.isLoading}),n("button",{key:"563dbe14a93a56f37e0caab0c4d9e68bd6bcb66a",type:"submit",disabled:this.isLoading,class:"send-button"},this.isLoading?"Envoi...":n("svg",{xmlns:"http://www.w3.org/2000/svg",width:this.iconSize,height:this.iconSize,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-send-horizontal-icon lucide-send-horizontal"},n("path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z"}),n("path",{d:"M6 12h16"}))))))))}};V.style=Q;const W=":host{display:block}@keyframes shimmer{0%{background-position:-200px 0}100%{background-position:calc(200px + 100%) 0}}.skeleton-container{position:relative}.skeleton-line{height:14px;background:linear-gradient(90deg, #e9ecef 25%, #f8f9fa 50%, #e9ecef 75%);background-size:200px 100%;animation:shimmer 1.5s infinite linear;border-radius:4px;margin-bottom:8px;position:relative;overflow:hidden}.skeleton-line:last-child{margin-bottom:0}.skeleton-line.line-1{width:95%}.skeleton-line.line-2{width:88%}.skeleton-line.line-3{width:72%}.skeleton-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(90deg, #e9ecef 25%, #f8f9fa 50%, #e9ecef 75%);background-size:200px 100%;animation:shimmer 1.5s infinite linear;margin-bottom:12px;display:inline-block}.skeleton-wrapper{display:flex;align-items:flex-start;gap:12px}.skeleton-content{flex:1}.skeleton-typing{display:flex;align-items:center;gap:4px;margin-top:8px}.skeleton-dot{width:6px;height:6px;border-radius:50%;background-color:#6c757d;animation:typing 1.4s infinite ease-in-out}.skeleton-dot:nth-child(1){animation-delay:-0.32s}.skeleton-dot:nth-child(2){animation-delay:-0.16s}.skeleton-dot:nth-child(3){animation-delay:0s}@keyframes typing{0%,80%,100%{opacity:0.3;transform:scale(0.8)}40%{opacity:1;transform:scale(1)}}.skeleton-glow{position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);animation:glow 2s infinite;border-radius:inherit}@keyframes glow{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}";const K=class{constructor(e){t(this,e)}render(){return n(i,{key:"2096c995089506157a76f0cf46cc0438202c388d"},n("div",{key:"ce78a4d4ef5aff3c73baa7721fee1ddd1cb41d24",class:"skeleton-container"},n("div",{key:"23473a136acc8ad67d870c804ccf78294e64221e",class:"skeleton-typing"},n("div",{key:"736709a3c4355b60b738073a2b30916a78a1a731",class:"skeleton-dot"}),n("div",{key:"e32141d131bc8fee237b5d50ea3a6bd65ee31caf",class:"skeleton-dot"}))))}};K.style=W;const tt=":host{max-width:600px;margin:0 auto;padding:20px;--main-color:#ff8834;font-family:'Yantramanav', serif, Arial, sans-serif}.chat-widget-container{position:fixed;bottom:10vh;right:24px;width:350px;background:white;border-radius:12px;box-shadow:0 2px 16px rgba(0, 0, 0, 0.15);z-index:999;display:flex;flex-direction:column;overflow:hidden}.chat-header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid #eee;background:var(--main-color);color:white;font-family:'Signika', Arial, sans-serif}.chat-title{margin:0;font-size:1.1rem;font-weight:600}.close-button{background:none;border:none;color:white;font-size:1.5rem;cursor:pointer}.message-container{flex:1;padding:16px;overflow-y:scroll;background:#f7fafc;min-height:250px;max-height:250px}.message{margin:12px 0;padding:12px 16px;border-radius:12px;max-width:80%;word-wrap:break-word;line-height:1.4}.user-message{background:linear-gradient(135deg, var(--main-color), #ff8834);color:white;margin-left:auto;width:fit-content;border-radius:20px 20px 0px 20px}.ai-message{background:hsla(240, 6%, 90%, 0.5);color:#333;margin-right:auto;width:fit-content;border-radius:20px 20px 20px 0px}.typing-indicator{min-height:24px;padding:0 16px;color:#888;font-size:0.9rem}.input-container{display:flex;border-top:1px solid #eee;padding:8px;background:#fff}.input{flex:1;border:1px solid #ccc;border-radius:6px;padding:8px;font-size:1rem;margin-right:8px;font-family:'Yantramanav', serif, Arial, sans-serif}.send-button{background:var(--main-color);color:white;border:none;border-radius:6px;padding:0 16px;font-size:1rem;cursor:pointer}.send-icon{width:20px;height:20px;vertical-align:middle}.chat-toggler{position:fixed;bottom:24px;right:24px;width:56px;height:56px;border-radius:50%;background:var(--main-color);color:white;border:none;box-shadow:0 2px 8px rgba(0, 0, 0, 0.15);display:flex;align-items:center;justify-content:center;font-size:2rem;cursor:pointer;z-index:999}.hide{display:none;opacity:0;z-index:-1;transform:translateY(50%)}";const et=class{constructor(e){t(this,e)}messages=[];isLoading=false;isChatContainerVisible=true;apiEndpoint=e.API_URL;conversationId="";inputEl;componentWillLoad(){this.conversationId=s();console.log("Generated conversation ID:",this.conversationId);this.loadFonts()}loadFonts(){const t=document.querySelector('link[href*="fonts.googleapis.com/css2?family=Signika"]');if(!t){const t=document.createElement("link");t.rel="stylesheet";t.href="https://fonts.googleapis.com/css2?family=Signika:wght@300..700&family=Yantramanav:wght@100;300;400;500;700;900&display=swap";document.head.appendChild(t)}}handleSubmit=async t=>{t.preventDefault();const e=this.inputEl;if(!e||!e.value.trim())return;const n=e.value;const i={role:"user",content:n,isComplete:true};this.messages=[...this.messages,i];e.value="";this.isLoading=true;const s=this.messages.length;this.messages=[...this.messages,{role:"ai",content:"",isComplete:false}];try{await r(n,this.apiEndpoint,this.conversationId,(t=>{const e=[...this.messages];e[s].content+=t;this.messages=e}),(()=>{this.isLoading=false;const t=[...this.messages];t[s].isComplete=true;this.messages=t}),(()=>{const t=[...this.messages];t[s]={...t[s],content:"Sorry, I encountered an error. Please try again.",isComplete:true};this.messages=t;this.isLoading=false}))}catch(t){const e=[...this.messages];e[s]={...e[s],content:"Sorry, I encountered an error. Please try again.",isComplete:true};this.messages=e;this.isLoading=false}};toggleChatContainer=()=>{this.isChatContainerVisible=!this.isChatContainerVisible};setInputRef=t=>{this.inputEl=t};render(){return[n("div",{key:"2ff5b5ae33293789f52949df59d49e4b81b1c429",class:{"chat-widget-container":true,hide:!this.isChatContainerVisible}},n("div",{key:"309a6c5b40fb62baf63f294da7b005c2e6a826cd",class:"chat-header"},n("h3",{key:"c0045f2d7b5cce8630fec2fc0f8169225a1e10bd",class:"chat-title"},"Que puis-je faire pour vous ?"),n("button",{key:"5f979d0d6738bbde5406c9921a511e69ff832455",class:"close-button",onClick:this.toggleChatContainer},"×")),n("div",{key:"c40c7ed6f9f0d8e5e66bdb122ea45c27d044f9b3",class:"message-container"},this.messages.map(((t,e)=>n("div",{key:e,class:{message:true,"user-message":t.role==="user","ai-message":t.role==="ai"}},t.role==="ai"?[this.isLoading&&t.content===""?n("chat-skeleton",null):n("span",null,t.content),t.isComplete&&n("satisfaction-buttons",null)]:n("span",null,t.content))))),n("form",{key:"1a8e303ab6415a0692b5126992991a4fb3c43127",class:"input-container",onSubmit:this.handleSubmit},n("input",{key:"3decf35ff1d8ee264a2db0a8145290d2764ca18a",type:"text",placeholder:"Type a message...",name:"message",required:true,class:"input",ref:this.setInputRef}),n("button",{key:"254b847ca89a8c3aef27b138653e17232b26319c",type:"submit",disabled:this.isLoading,class:"send-button"},this.isLoading?"Envoi...":n("svg",{class:"send-icon",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},n("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),n("polygon",{points:"22 2 15 22 11 13 2 9 22 2"}))))),n("button",{key:"487fe86437fec8e4248cf46ce8f7f0d4300e033e",class:"chat-toggler",onClick:this.toggleChatContainer},n("svg",{key:"9c87d589b79279a9eb76208160fa7da3a4f1582a",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},n("path",{key:"7281ef8d8c96dbeabe138cdd8b8d321da3569553",d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"})))]}};et.style=tt;const nt=":host{display:block}";const it=class{constructor(e){t(this,e)}render(){return n(i,{key:"e56f4f726bcc459c89e8977f04476b00a5fcd74e"},n("slot",{key:"885a78c0da5410eaa0d6e06ff7ea311685f16e6c"}))}};it.style=nt;export{V as chat_modal,K as chat_skeleton,et as chat_widget,it as satisfaction_buttons};
//# sourceMappingURL=p-a1386be1.entry.js.map