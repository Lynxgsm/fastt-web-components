import{r as t,E as e,h as n,H as i}from"./p-_TQhFv3x.js";function s(){const t=Date.now();const e=Math.random().toString(36).substring(2,15);return`conv_${t}_${e}`}async function r(t,e,n,i,s,r){try{const r=await fetch(`${e}/conversation/stream`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream","Cache-Control":"no-cache"},body:JSON.stringify({prompt:t,conversation_id:n})});if(!r.ok){throw new Error(`API request failed: ${r.status} ${r.statusText}`)}const o=r.body?.getReader();const a=new TextDecoder;let c="";if(!o){throw new Error("Failed to get response reader")}while(true){const{done:t,value:e}=await o.read();if(t){c+=a.decode();const t=c.split("\n");for(const e of t){if(e.startsWith("data: ")){const t=e.slice(6);if(t==="[DONE]"){s?.();return}try{const e=JSON.parse(t);if(e.content){i(e.content)}}catch(e){if(t.trim()){i(t)}}}}s?.();break}c+=a.decode(e,{stream:true});let n=c.split("\n");c=n.pop()||"";for(const t of n){if(t.startsWith("data: ")){const e=t.slice(6);if(e==="[DONE]"){s?.();return}try{const t=JSON.parse(e);if(t.content){i(t.content)}}catch(t){if(e.trim()){i(e)}}}}}}catch(t){r?.(t)}}async function o(t,e,n,i,s){try{const s=await fetch(`${e}/conversation/feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({conversation_id:n,is_satisfied:t})});if(!s.ok){throw new Error(`API request failed: ${s.status} ${s.statusText}`)}i?.()}catch(t){}}function a(){return{async:false,baseUrl:null,breaks:false,extensions:null,gfm:true,headerIds:true,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:true,pedantic:false,renderer:null,sanitize:false,sanitizer:null,silent:false,smartypants:false,tokenizer:null,walkTokens:null,xhtml:false}}let c=a();function l(t){c=t}const h=/[&<>"']/;const d=new RegExp(h.source,"g");const f=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/;const u=new RegExp(f.source,"g");const p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};const g=t=>p[t];function b(t,e){if(e){if(h.test(t)){return t.replace(d,g)}}else{if(f.test(t)){return t.replace(u,g)}}return t}const m=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function x(t){return t.replace(m,((t,e)=>{e=e.toLowerCase();if(e==="colon")return":";if(e.charAt(0)==="#"){return e.charAt(1)==="x"?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1))}return""}))}const k=/(^|[^\[])\^/g;function w(t,e){t=typeof t==="string"?t:t.source;e=e||"";const n={replace:(e,i)=>{i=i.source||i;i=i.replace(k,"$1");t=t.replace(e,i);return n},getRegex:()=>new RegExp(t,e)};return n}const y=/[^\w:]/g;const v=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function $(t,e,n){if(t){let t;try{t=decodeURIComponent(x(n)).replace(y,"").toLowerCase()}catch(t){return null}if(t.indexOf("javascript:")===0||t.indexOf("vbscript:")===0||t.indexOf("data:")===0){return null}}if(e&&!v.test(n)){n=E(e,n)}try{n=encodeURI(n).replace(/%25/g,"%")}catch(t){return null}return n}const _={};const z=/^[^:]+:\/*[^/]*$/;const S=/^([^:]+:)[\s\S]*$/;const A=/^([^:]+:\/*[^/]*)[\s\S]*$/;function E(t,e){if(!_[" "+t]){if(z.test(t)){_[" "+t]=t+"/"}else{_[" "+t]=Z(t,"/",true)}}t=_[" "+t];const n=t.indexOf(":")===-1;if(e.substring(0,2)==="//"){if(n){return e}return t.replace(S,"$1")+e}else if(e.charAt(0)==="/"){if(n){return e}return t.replace(A,"$1")+e}else{return t+e}}const C={exec:function t(){}};function I(t,e){const n=t.replace(/\|/g,((t,e,n)=>{let i=false,s=e;while(--s>=0&&n[s]==="\\")i=!i;if(i){return"|"}else{return" |"}})),i=n.split(/ \|/);let s=0;if(!i[0].trim()){i.shift()}if(i.length>0&&!i[i.length-1].trim()){i.pop()}if(i.length>e){i.splice(e)}else{while(i.length<e)i.push("")}for(;s<i.length;s++){i[s]=i[s].trim().replace(/\\\|/g,"|")}return i}function Z(t,e,n){const i=t.length;if(i===0){return""}let s=0;while(s<i){const r=t.charAt(i-s-1);if(r===e&&!n){s++}else if(r!==e&&n){s++}else{break}}return t.slice(0,i-s)}function M(t,e){if(t.indexOf(e[1])===-1){return-1}const n=t.length;let i=0,s=0;for(;s<n;s++){if(t[s]==="\\"){s++}else if(t[s]===e[0]){i++}else if(t[s]===e[1]){i--;if(i<0){return s}}}return-1}function T(t){if(t&&t.sanitize&&!t.silent){console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}}function j(t,e){if(e<1){return""}let n="";while(e>1){if(e&1){n+=t}e>>=1;t+=t}return n+t}function q(t,e,n,i){const s=e.href;const r=e.title?b(e.title):null;const o=t[1].replace(/\\([\[\]])/g,"$1");if(t[0].charAt(0)!=="!"){i.state.inLink=true;const t={type:"link",raw:n,href:s,title:r,text:o,tokens:i.inlineTokens(o)};i.state.inLink=false;return t}return{type:"image",raw:n,href:s,title:r,text:b(o)}}function R(t,e){const n=t.match(/^(\s+)(?:```)/);if(n===null){return e}const i=n[1];return e.split("\n").map((t=>{const e=t.match(/^\s+/);if(e===null){return t}const[n]=e;if(n.length>=i.length){return t.slice(i.length)}return t})).join("\n")}class P{constructor(t){this.options=t||c}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0){return{type:"space",raw:e[0]}}}code(t){const e=this.rules.block.code.exec(t);if(e){const t=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:!this.options.pedantic?Z(t,"\n"):t}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const t=e[0];const n=R(t,e[3]||"");return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline._escapes,"$1"):e[2],text:n}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let t=e[2].trim();if(/#$/.test(t)){const e=Z(t,"#");if(this.options.pedantic){t=e.trim()}else if(!e||/ $/.test(e)){t=e.trim()}}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e){return{type:"hr",raw:e[0]}}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){const t=e[0].replace(/^ *>[ \t]?/gm,"");const n=this.lexer.state.top;this.lexer.state.top=true;const i=this.lexer.blockTokens(t);this.lexer.state.top=n;return{type:"blockquote",raw:e[0],tokens:i,text:t}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n,i,s,r,o,a,c,l,h,d,f,u;let p=e[1].trim();const g=p.length>1;const b={type:"list",raw:"",ordered:g,start:g?+p.slice(0,-1):"",loose:false,items:[]};p=g?`\\d{1,9}\\${p.slice(-1)}`:`\\${p}`;if(this.options.pedantic){p=g?p:"[*+-]"}const m=new RegExp(`^( {0,3}${p})((?:[\t ][^\\n]*)?(?:\\n|$))`);while(t){u=false;if(!(e=m.exec(t))){break}if(this.rules.block.hr.test(t)){break}n=e[0];t=t.substring(n.length);l=e[2].split("\n",1)[0].replace(/^\t+/,(t=>" ".repeat(3*t.length)));h=t.split("\n",1)[0];if(this.options.pedantic){r=2;f=l.trimLeft()}else{r=e[2].search(/[^ ]/);r=r>4?1:r;f=l.slice(r);r+=e[1].length}a=false;if(!l&&/^ *$/.test(h)){n+=h+"\n";t=t.substring(h.length+1);u=true}if(!u){const e=new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`);const i=new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`);const s=new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`);const o=new RegExp(`^ {0,${Math.min(3,r-1)}}#`);while(t){d=t.split("\n",1)[0];h=d;if(this.options.pedantic){h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")}if(s.test(h)){break}if(o.test(h)){break}if(e.test(h)){break}if(i.test(t)){break}if(h.search(/[^ ]/)>=r||!h.trim()){f+="\n"+h.slice(r)}else{if(a){break}if(l.search(/[^ ]/)>=4){break}if(s.test(l)){break}if(o.test(l)){break}if(i.test(l)){break}f+="\n"+h}if(!a&&!h.trim()){a=true}n+=d+"\n";t=t.substring(d.length+1);l=h.slice(r)}}if(!b.loose){if(c){b.loose=true}else if(/\n *\n *$/.test(n)){c=true}}if(this.options.gfm){i=/^\[[ xX]\] /.exec(f);if(i){s=i[0]!=="[ ] ";f=f.replace(/^\[[ xX]\] +/,"")}}b.items.push({type:"list_item",raw:n,task:!!i,checked:s,loose:false,text:f});b.raw+=n}b.items[b.items.length-1].raw=n.trimRight();b.items[b.items.length-1].text=f.trimRight();b.raw=b.raw.trimRight();const x=b.items.length;for(o=0;o<x;o++){this.lexer.state.top=false;b.items[o].tokens=this.lexer.blockTokens(b.items[o].text,[]);if(!b.loose){const t=b.items[o].tokens.filter((t=>t.type==="space"));const e=t.length>0&&t.some((t=>/\n.*\n/.test(t.raw)));b.loose=e}}if(b.loose){for(o=0;o<x;o++){b.items[o].loose=true}}return b}}html(t){const e=this.rules.block.html.exec(t);if(e){const t={type:"html",raw:e[0],pre:!this.options.sanitizer&&(e[1]==="pre"||e[1]==="script"||e[1]==="style"),text:e[0]};if(this.options.sanitize){const n=this.options.sanitizer?this.options.sanitizer(e[0]):b(e[0]);t.type="paragraph";t.text=n;t.tokens=this.lexer.inline(n)}return t}}def(t){const e=this.rules.block.def.exec(t);if(e){const t=e[1].toLowerCase().replace(/\s+/g," ");const n=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"";const i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline._escapes,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:n,title:i}}}table(t){const e=this.rules.block.table.exec(t);if(e){const t={type:"table",header:I(e[1]).map((t=>({text:t}))),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(t.header.length===t.align.length){t.raw=e[0];let n=t.align.length;let i,s,r,o;for(i=0;i<n;i++){if(/^ *-+: *$/.test(t.align[i])){t.align[i]="right"}else if(/^ *:-+: *$/.test(t.align[i])){t.align[i]="center"}else if(/^ *:-+ *$/.test(t.align[i])){t.align[i]="left"}else{t.align[i]=null}}n=t.rows.length;for(i=0;i<n;i++){t.rows[i]=I(t.rows[i],t.header.length).map((t=>({text:t})))}n=t.header.length;for(s=0;s<n;s++){t.header[s].tokens=this.lexer.inline(t.header[s].text)}n=t.rows.length;for(s=0;s<n;s++){o=t.rows[s];for(r=0;r<o.length;r++){o[r].tokens=this.lexer.inline(o[r].text)}}return t}}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e){return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const t=e[1].charAt(e[1].length-1)==="\n"?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(t){const e=this.rules.block.text.exec(t);if(e){return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}}escape(t){const e=this.rules.inline.escape.exec(t);if(e){return{type:"escape",raw:e[0],text:b(e[1])}}}tag(t){const e=this.rules.inline.tag.exec(t);if(e){if(!this.lexer.state.inLink&&/^<a /i.test(e[0])){this.lexer.state.inLink=true}else if(this.lexer.state.inLink&&/^<\/a>/i.test(e[0])){this.lexer.state.inLink=false}if(!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])){this.lexer.state.inRawBlock=true}else if(this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])){this.lexer.state.inRawBlock=false}return{type:this.options.sanitize?"text":"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):b(e[0]):e[0]}}}link(t){const e=this.rules.inline.link.exec(t);if(e){const t=e[2].trim();if(!this.options.pedantic&&/^</.test(t)){if(!/>$/.test(t)){return}const e=Z(t.slice(0,-1),"\\");if((t.length-e.length)%2===0){return}}else{const t=M(e[2],"()");if(t>-1){const n=e[0].indexOf("!")===0?5:4;const i=n+e[1].length+t;e[2]=e[2].substring(0,t);e[0]=e[0].substring(0,i).trim();e[3]=""}}let n=e[2];let i="";if(this.options.pedantic){const t=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);if(t){n=t[1];i=t[3]}}else{i=e[3]?e[3].slice(1,-1):""}n=n.trim();if(/^</.test(n)){if(this.options.pedantic&&!/>$/.test(t)){n=n.slice(1)}else{n=n.slice(1,-1)}}return q(e,{href:n?n.replace(this.rules.inline._escapes,"$1"):n,title:i?i.replace(this.rules.inline._escapes,"$1"):i},e[0],this.lexer)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let t=(n[2]||n[1]).replace(/\s+/g," ");t=e[t.toLowerCase()];if(!t){const t=n[0].charAt(0);return{type:"text",raw:t,text:t}}return q(n,t,n[0],this.lexer)}}emStrong(t,e,n=""){let i=this.rules.inline.emStrong.lDelim.exec(t);if(!i)return;if(i[3]&&n.match(/[\p{L}\p{N}]/u))return;const s=i[1]||i[2]||"";if(!s||s&&(n===""||this.rules.inline.punctuation.exec(n))){const n=i[0].length-1;let s,r,o=n,a=0;const c=i[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;c.lastIndex=0;e=e.slice(-1*t.length+n);while((i=c.exec(e))!=null){s=i[1]||i[2]||i[3]||i[4]||i[5]||i[6];if(!s)continue;r=s.length;if(i[3]||i[4]){o+=r;continue}else if(i[5]||i[6]){if(n%3&&!((n+r)%3)){a+=r;continue}}o-=r;if(o>0)continue;r=Math.min(r,r+o+a);const e=t.slice(0,n+i.index+(i[0].length-s.length)+r);if(Math.min(n,r)%2){const t=e.slice(1,-1);return{type:"em",raw:e,text:t,tokens:this.lexer.inlineTokens(t)}}const c=e.slice(2,-2);return{type:"strong",raw:e,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let t=e[2].replace(/\n/g," ");const n=/[^ ]/.test(t);const i=/^ /.test(t)&&/ $/.test(t);if(n&&i){t=t.substring(1,t.length-1)}t=b(t,true);return{type:"codespan",raw:e[0],text:t}}}br(t){const e=this.rules.inline.br.exec(t);if(e){return{type:"br",raw:e[0]}}}del(t){const e=this.rules.inline.del.exec(t);if(e){return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}}autolink(t,e){const n=this.rules.inline.autolink.exec(t);if(n){let t,i;if(n[2]==="@"){t=b(this.options.mangle?e(n[1]):n[1]);i="mailto:"+t}else{t=b(n[1]);i=t}return{type:"link",raw:n[0],text:t,href:i,tokens:[{type:"text",raw:t,text:t}]}}}url(t,e){let n;if(n=this.rules.inline.url.exec(t)){let t,i;if(n[2]==="@"){t=b(this.options.mangle?e(n[0]):n[0]);i="mailto:"+t}else{let e;do{e=n[0];n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(e!==n[0]);t=b(n[0]);if(n[1]==="www."){i="http://"+n[0]}else{i=n[0]}}return{type:"link",raw:n[0],text:t,href:i,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(t,e){const n=this.rules.inline.text.exec(t);if(n){let t;if(this.lexer.state.inRawBlock){t=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):b(n[0]):n[0]}else{t=b(this.options.smartypants?e(n[0]):n[0])}return{type:"text",raw:n[0],text:t}}}}const D={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:"+"<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)"+"|comment[^\\n]*(\\n+|$)"+"|<\\?[\\s\\S]*?(?:\\?>\\n*|$)"+"|<![A-Z][\\s\\S]*?(?:>\\n*|$)"+"|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)"+"|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)"+"|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)"+"|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)"+")",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:C,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};D._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;D._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;D.def=w(D.def).replace("label",D._label).replace("title",D._title).getRegex();D.bullet=/(?:[*+-]|\d{1,9}[.)])/;D.listItemStart=w(/^( *)(bull) */).replace("bull",D.bullet).getRegex();D.list=w(D.list).replace(/bull/g,D.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+D.def.source+")").getRegex();D._tag="address|article|aside|base|basefont|blockquote|body|caption"+"|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption"+"|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe"+"|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option"+"|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr"+"|track|ul";D._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;D.html=w(D.html,"i").replace("comment",D._comment).replace("tag",D._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();D.paragraph=w(D._paragraph).replace("hr",D.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D._tag).getRegex();D.blockquote=w(D.blockquote).replace("paragraph",D.paragraph).getRegex();D.normal={...D};D.gfm={...D.normal,table:"^ *([^\\n ].*\\|.*)\\n"+" {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?"+"(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};D.gfm.table=w(D.gfm.table).replace("hr",D.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D._tag).getRegex();D.gfm.paragraph=w(D._paragraph).replace("hr",D.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",D.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D._tag).getRegex();D.pedantic={...D.normal,html:w("^ *(?:comment *(?:\\n|\\s*$)"+"|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)"+"|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",D._comment).replace(/tag/g,"(?!(?:"+"a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub"+"|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)"+"\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:C,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:w(D.normal._paragraph).replace("hr",D.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",D.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const L={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:C,tag:"^comment"+"|^</[a-zA-Z][\\w:-]*\\s*>"+"|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>"+"|^<\\?[\\s\\S]*?\\?>"+"|^<![a-zA-Z]+\\s[\\s\\S]*?>"+"|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:C,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};L._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";L.punctuation=w(L.punctuation).replace(/punctuation/g,L._punctuation).getRegex();L.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;L.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;L._comment=w(D._comment).replace("(?:--\x3e|$)","--\x3e").getRegex();L.emStrong.lDelim=w(L.emStrong.lDelim).replace(/punct/g,L._punctuation).getRegex();L.emStrong.rDelimAst=w(L.emStrong.rDelimAst,"g").replace(/punct/g,L._punctuation).getRegex();L.emStrong.rDelimUnd=w(L.emStrong.rDelimUnd,"g").replace(/punct/g,L._punctuation).getRegex();L._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;L._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;L._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;L.autolink=w(L.autolink).replace("scheme",L._scheme).replace("email",L._email).getRegex();L._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;L.tag=w(L.tag).replace("comment",L._comment).replace("attribute",L._attribute).getRegex();L._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;L._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;L._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;L.link=w(L.link).replace("label",L._label).replace("href",L._href).replace("title",L._title).getRegex();L.reflink=w(L.reflink).replace("label",L._label).replace("ref",D._label).getRegex();L.nolink=w(L.nolink).replace("ref",D._label).getRegex();L.reflinkSearch=w(L.reflinkSearch,"g").replace("reflink",L.reflink).replace("nolink",L.nolink).getRegex();L.normal={...L};L.pedantic={...L.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:w(/^!?\[(label)\]\((.*?)\)/).replace("label",L._label).getRegex(),reflink:w(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",L._label).getRegex()};L.gfm={...L.normal,escape:w(L.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};L.gfm.url=w(L.gfm.url,"i").replace("email",L.gfm._extended_email).getRegex();L.breaks={...L.gfm,br:w(L.br).replace("{2,}","*").getRegex(),text:w(L.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function O(t){return t.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function N(t){let e="",n,i;const s=t.length;for(n=0;n<s;n++){i=t.charCodeAt(n);if(Math.random()>.5){i="x"+i.toString(16)}e+="&#"+i+";"}return e}class B{constructor(t){this.tokens=[];this.tokens.links=Object.create(null);this.options=t||c;this.options.tokenizer=this.options.tokenizer||new P;this.tokenizer=this.options.tokenizer;this.tokenizer.options=this.options;this.tokenizer.lexer=this;this.inlineQueue=[];this.state={inLink:false,inRawBlock:false,top:true};const e={block:D.normal,inline:L.normal};if(this.options.pedantic){e.block=D.pedantic;e.inline=L.pedantic}else if(this.options.gfm){e.block=D.gfm;if(this.options.breaks){e.inline=L.breaks}else{e.inline=L.gfm}}this.tokenizer.rules=e}static get rules(){return{block:D,inline:L}}static lex(t,e){const n=new B(e);return n.lex(t)}static lexInline(t,e){const n=new B(e);return n.inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,"\n");this.blockTokens(t,this.tokens);let e;while(e=this.inlineQueue.shift()){this.inlineTokens(e.src,e.tokens)}return this.tokens}blockTokens(t,e=[]){if(this.options.pedantic){t=t.replace(/\t/g,"    ").replace(/^ +$/gm,"")}else{t=t.replace(/^( *)(\t+)/gm,((t,e,n)=>e+"    ".repeat(n.length)))}let n,i,s,r;while(t){if(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((i=>{if(n=i.call({lexer:this},t,e)){t=t.substring(n.raw.length);e.push(n);return true}return false}))){continue}if(n=this.tokenizer.space(t)){t=t.substring(n.raw.length);if(n.raw.length===1&&e.length>0){e[e.length-1].raw+="\n"}else{e.push(n)}continue}if(n=this.tokenizer.code(t)){t=t.substring(n.raw.length);i=e[e.length-1];if(i&&(i.type==="paragraph"||i.type==="text")){i.raw+="\n"+n.raw;i.text+="\n"+n.text;this.inlineQueue[this.inlineQueue.length-1].src=i.text}else{e.push(n)}continue}if(n=this.tokenizer.fences(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.heading(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.hr(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.blockquote(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.list(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.html(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.def(t)){t=t.substring(n.raw.length);i=e[e.length-1];if(i&&(i.type==="paragraph"||i.type==="text")){i.raw+="\n"+n.raw;i.text+="\n"+n.raw;this.inlineQueue[this.inlineQueue.length-1].src=i.text}else if(!this.tokens.links[n.tag]){this.tokens.links[n.tag]={href:n.href,title:n.title}}continue}if(n=this.tokenizer.table(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.lheading(t)){t=t.substring(n.raw.length);e.push(n);continue}s=t;if(this.options.extensions&&this.options.extensions.startBlock){let e=Infinity;const n=t.slice(1);let i;this.options.extensions.startBlock.forEach((function(t){i=t.call({lexer:this},n);if(typeof i==="number"&&i>=0){e=Math.min(e,i)}}));if(e<Infinity&&e>=0){s=t.substring(0,e+1)}}if(this.state.top&&(n=this.tokenizer.paragraph(s))){i=e[e.length-1];if(r&&i.type==="paragraph"){i.raw+="\n"+n.raw;i.text+="\n"+n.text;this.inlineQueue.pop();this.inlineQueue[this.inlineQueue.length-1].src=i.text}else{e.push(n)}r=s.length!==t.length;t=t.substring(n.raw.length);continue}if(n=this.tokenizer.text(t)){t=t.substring(n.raw.length);i=e[e.length-1];if(i&&i.type==="text"){i.raw+="\n"+n.raw;i.text+="\n"+n.text;this.inlineQueue.pop();this.inlineQueue[this.inlineQueue.length-1].src=i.text}else{e.push(n)}continue}if(t){const e="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(e);break}else{throw new Error(e)}}}this.state.top=true;return e}inline(t,e=[]){this.inlineQueue.push({src:t,tokens:e});return e}inlineTokens(t,e=[]){let n,i,s;let r=t;let o;let a,c;if(this.tokens.links){const t=Object.keys(this.tokens.links);if(t.length>0){while((o=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null){if(t.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))){r=r.slice(0,o.index)+"["+j("a",o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex)}}}}while((o=this.tokenizer.rules.inline.blockSkip.exec(r))!=null){r=r.slice(0,o.index)+"["+j("a",o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex)}while((o=this.tokenizer.rules.inline.escapedEmSt.exec(r))!=null){r=r.slice(0,o.index+o[0].length-2)+"++"+r.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);this.tokenizer.rules.inline.escapedEmSt.lastIndex--}while(t){if(!a){c=""}a=false;if(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((i=>{if(n=i.call({lexer:this},t,e)){t=t.substring(n.raw.length);e.push(n);return true}return false}))){continue}if(n=this.tokenizer.escape(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.tag(t)){t=t.substring(n.raw.length);i=e[e.length-1];if(i&&n.type==="text"&&i.type==="text"){i.raw+=n.raw;i.text+=n.text}else{e.push(n)}continue}if(n=this.tokenizer.link(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(n.raw.length);i=e[e.length-1];if(i&&n.type==="text"&&i.type==="text"){i.raw+=n.raw;i.text+=n.text}else{e.push(n)}continue}if(n=this.tokenizer.emStrong(t,r,c)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.codespan(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.br(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.del(t)){t=t.substring(n.raw.length);e.push(n);continue}if(n=this.tokenizer.autolink(t,N)){t=t.substring(n.raw.length);e.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(t,N))){t=t.substring(n.raw.length);e.push(n);continue}s=t;if(this.options.extensions&&this.options.extensions.startInline){let e=Infinity;const n=t.slice(1);let i;this.options.extensions.startInline.forEach((function(t){i=t.call({lexer:this},n);if(typeof i==="number"&&i>=0){e=Math.min(e,i)}}));if(e<Infinity&&e>=0){s=t.substring(0,e+1)}}if(n=this.tokenizer.inlineText(s,O)){t=t.substring(n.raw.length);if(n.raw.slice(-1)!=="_"){c=n.raw.slice(-1)}a=true;i=e[e.length-1];if(i&&i.type==="text"){i.raw+=n.raw;i.text+=n.text}else{e.push(n)}continue}if(t){const e="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(e);break}else{throw new Error(e)}}}return e}}class F{constructor(t){this.options=t||c}code(t,e,n){const i=(e||"").match(/\S*/)[0];if(this.options.highlight){const e=this.options.highlight(t,i);if(e!=null&&e!==t){n=true;t=e}}t=t.replace(/\n$/,"")+"\n";if(!i){return"<pre><code>"+(n?t:b(t,true))+"</code></pre>\n"}return'<pre><code class="'+this.options.langPrefix+b(i)+'">'+(n?t:b(t,true))+"</code></pre>\n"}blockquote(t){return`<blockquote>\n${t}</blockquote>\n`}html(t){return t}heading(t,e,n,i){if(this.options.headerIds){const s=this.options.headerPrefix+i.slug(n);return`<h${e} id="${s}">${t}</h${e}>\n`}return`<h${e}>${t}</h${e}>\n`}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(t,e,n){const i=e?"ol":"ul",s=e&&n!==1?' start="'+n+'"':"";return"<"+i+s+">\n"+t+"</"+i+">\n"}listitem(t){return`<li>${t}</li>\n`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return`<p>${t}</p>\n`}table(t,e){if(e)e=`<tbody>${e}</tbody>`;return"<table>\n"+"<thead>\n"+t+"</thead>\n"+e+"</table>\n"}tablerow(t){return`<tr>\n${t}</tr>\n`}tablecell(t,e){const n=e.header?"th":"td";const i=e.align?`<${n} align="${e.align}">`:`<${n}>`;return i+t+`</${n}>\n`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return`<del>${t}</del>`}link(t,e,n){t=$(this.options.sanitize,this.options.baseUrl,t);if(t===null){return n}let i='<a href="'+t+'"';if(e){i+=' title="'+e+'"'}i+=">"+n+"</a>";return i}image(t,e,n){t=$(this.options.sanitize,this.options.baseUrl,t);if(t===null){return n}let i=`<img src="${t}" alt="${n}"`;if(e){i+=` title="${e}"`}i+=this.options.xhtml?"/>":">";return i}text(t){return t}}class U{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,e,n){return""+n}image(t,e,n){return""+n}br(){return""}}class Y{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,e){let n=t;let i=0;if(this.seen.hasOwnProperty(n)){i=this.seen[t];do{i++;n=t+"-"+i}while(this.seen.hasOwnProperty(n))}if(!e){this.seen[t]=i;this.seen[n]=0}return n}slug(t,e={}){const n=this.serialize(t);return this.getNextSafeSlug(n,e.dryrun)}}class H{constructor(t){this.options=t||c;this.options.renderer=this.options.renderer||new F;this.renderer=this.options.renderer;this.renderer.options=this.options;this.textRenderer=new U;this.slugger=new Y}static parse(t,e){const n=new H(e);return n.parse(t)}static parseInline(t,e){const n=new H(e);return n.parseInline(t)}parse(t,e=true){let n="",i,s,r,o,a,c,l,h,d,f,u,p,g,b,m,k,w,y,v;const $=t.length;for(i=0;i<$;i++){f=t[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[f.type]){v=this.options.extensions.renderers[f.type].call({parser:this},f);if(v!==false||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(f.type)){n+=v||"";continue}}switch(f.type){case"space":{continue}case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(f.tokens),f.depth,x(this.parseInline(f.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(f.text,f.lang,f.escaped);continue}case"table":{h="";l="";o=f.header.length;for(s=0;s<o;s++){l+=this.renderer.tablecell(this.parseInline(f.header[s].tokens),{header:true,align:f.align[s]})}h+=this.renderer.tablerow(l);d="";o=f.rows.length;for(s=0;s<o;s++){c=f.rows[s];l="";a=c.length;for(r=0;r<a;r++){l+=this.renderer.tablecell(this.parseInline(c[r].tokens),{header:false,align:f.align[r]})}d+=this.renderer.tablerow(l)}n+=this.renderer.table(h,d);continue}case"blockquote":{d=this.parse(f.tokens);n+=this.renderer.blockquote(d);continue}case"list":{u=f.ordered;p=f.start;g=f.loose;o=f.items.length;d="";for(s=0;s<o;s++){m=f.items[s];k=m.checked;w=m.task;b="";if(m.task){y=this.renderer.checkbox(k);if(g){if(m.tokens.length>0&&m.tokens[0].type==="paragraph"){m.tokens[0].text=y+" "+m.tokens[0].text;if(m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&m.tokens[0].tokens[0].type==="text"){m.tokens[0].tokens[0].text=y+" "+m.tokens[0].tokens[0].text}}else{m.tokens.unshift({type:"text",text:y})}}else{b+=y}}b+=this.parse(m.tokens,g);d+=this.renderer.listitem(b,w,k)}n+=this.renderer.list(d,u,p);continue}case"html":{n+=this.renderer.html(f.text);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(f.tokens));continue}case"text":{d=f.tokens?this.parseInline(f.tokens):f.text;while(i+1<$&&t[i+1].type==="text"){f=t[++i];d+="\n"+(f.tokens?this.parseInline(f.tokens):f.text)}n+=e?this.renderer.paragraph(d):d;continue}default:{const t='Token with "'+f.type+'" type was not found.';if(this.options.silent){console.error(t);return}else{throw new Error(t)}}}}return n}parseInline(t,e){e=e||this.renderer;let n="",i,s,r;const o=t.length;for(i=0;i<o;i++){s=t[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){r=this.options.extensions.renderers[s.type].call({parser:this},s);if(r!==false||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=r||"";continue}}switch(s.type){case"escape":{n+=e.text(s.text);break}case"html":{n+=e.html(s.text);break}case"link":{n+=e.link(s.href,s.title,this.parseInline(s.tokens,e));break}case"image":{n+=e.image(s.href,s.title,s.text);break}case"strong":{n+=e.strong(this.parseInline(s.tokens,e));break}case"em":{n+=e.em(this.parseInline(s.tokens,e));break}case"codespan":{n+=e.codespan(s.text);break}case"br":{n+=e.br();break}case"del":{n+=e.del(this.parseInline(s.tokens,e));break}case"text":{n+=e.text(s.text);break}default:{const t='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(t);return}else{throw new Error(t)}}}}return n}}class X{constructor(t){this.options=t||c}static passThroughHooks=new Set(["preprocess","postprocess"]);preprocess(t){return t}postprocess(t){return t}}function J(t,e,n){return i=>{i.message+="\nPlease report this to https://github.com/markedjs/marked.";if(t){const t="<p>An error occurred:</p><pre>"+b(i.message+"",true)+"</pre>";if(e){return Promise.resolve(t)}if(n){n(null,t);return}return t}if(e){return Promise.reject(i)}if(n){n(i);return}throw i}}function G(t,e){return(n,i,s)=>{if(typeof i==="function"){s=i;i=null}const r={...i};i={...Q.defaults,...r};const o=J(i.silent,i.async,s);if(typeof n==="undefined"||n===null){return o(new Error("marked(): input parameter is undefined or null"))}if(typeof n!=="string"){return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"))}T(i);if(i.hooks){i.hooks.options=i}if(s){const r=i.highlight;let a;try{if(i.hooks){n=i.hooks.preprocess(n)}a=t(n,i)}catch(t){return o(t)}const c=function(t){let n;if(!t){try{if(i.walkTokens){Q.walkTokens(a,i.walkTokens)}n=e(a,i);if(i.hooks){n=i.hooks.postprocess(n)}}catch(e){t=e}}i.highlight=r;return t?o(t):s(null,n)};if(!r||r.length<3){return c()}delete i.highlight;if(!a.length)return c();let l=0;Q.walkTokens(a,(function(t){if(t.type==="code"){l++;setTimeout((()=>{r(t.text,t.lang,(function(e,n){if(e){return c(e)}if(n!=null&&n!==t.text){t.text=n;t.escaped=true}l--;if(l===0){c()}}))}),0)}}));if(l===0){c()}return}if(i.async){return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then((e=>t(e,i))).then((t=>i.walkTokens?Promise.all(Q.walkTokens(t,i.walkTokens)).then((()=>t)):t)).then((t=>e(t,i))).then((t=>i.hooks?i.hooks.postprocess(t):t)).catch(o)}try{if(i.hooks){n=i.hooks.preprocess(n)}const s=t(n,i);if(i.walkTokens){Q.walkTokens(s,i.walkTokens)}let r=e(s,i);if(i.hooks){r=i.hooks.postprocess(r)}return r}catch(t){return o(t)}}}function Q(t,e,n){return G(B.lex,H.parse)(t,e,n)}Q.options=Q.setOptions=function(t){Q.defaults={...Q.defaults,...t};l(Q.defaults);return Q};Q.getDefaults=a;Q.defaults=c;Q.use=function(...t){const e=Q.defaults.extensions||{renderers:{},childTokens:{}};t.forEach((t=>{const n={...t};n.async=Q.defaults.async||n.async||false;if(t.extensions){t.extensions.forEach((t=>{if(!t.name){throw new Error("extension name required")}if(t.renderer){const n=e.renderers[t.name];if(n){e.renderers[t.name]=function(...e){let i=t.renderer.apply(this,e);if(i===false){i=n.apply(this,e)}return i}}else{e.renderers[t.name]=t.renderer}}if(t.tokenizer){if(!t.level||t.level!=="block"&&t.level!=="inline"){throw new Error("extension level must be 'block' or 'inline'")}if(e[t.level]){e[t.level].unshift(t.tokenizer)}else{e[t.level]=[t.tokenizer]}if(t.start){if(t.level==="block"){if(e.startBlock){e.startBlock.push(t.start)}else{e.startBlock=[t.start]}}else if(t.level==="inline"){if(e.startInline){e.startInline.push(t.start)}else{e.startInline=[t.start]}}}}if(t.childTokens){e.childTokens[t.name]=t.childTokens}}));n.extensions=e}if(t.renderer){const e=Q.defaults.renderer||new F;for(const n in t.renderer){const i=e[n];e[n]=(...s)=>{let r=t.renderer[n].apply(e,s);if(r===false){r=i.apply(e,s)}return r}}n.renderer=e}if(t.tokenizer){const e=Q.defaults.tokenizer||new P;for(const n in t.tokenizer){const i=e[n];e[n]=(...s)=>{let r=t.tokenizer[n].apply(e,s);if(r===false){r=i.apply(e,s)}return r}}n.tokenizer=e}if(t.hooks){const e=Q.defaults.hooks||new X;for(const n in t.hooks){const i=e[n];if(X.passThroughHooks.has(n)){e[n]=s=>{if(Q.defaults.async){return Promise.resolve(t.hooks[n].call(e,s)).then((t=>i.call(e,t)))}const r=t.hooks[n].call(e,s);return i.call(e,r)}}else{e[n]=(...s)=>{let r=t.hooks[n].apply(e,s);if(r===false){r=i.apply(e,s)}return r}}}n.hooks=e}if(t.walkTokens){const e=Q.defaults.walkTokens;n.walkTokens=function(n){let i=[];i.push(t.walkTokens.call(this,n));if(e){i=i.concat(e.call(this,n))}return i}}Q.setOptions(n)}))};Q.walkTokens=function(t,e){let n=[];for(const i of t){n=n.concat(e.call(Q,i));switch(i.type){case"table":{for(const t of i.header){n=n.concat(Q.walkTokens(t.tokens,e))}for(const t of i.rows){for(const i of t){n=n.concat(Q.walkTokens(i.tokens,e))}}break}case"list":{n=n.concat(Q.walkTokens(i.items,e));break}default:{if(Q.defaults.extensions&&Q.defaults.extensions.childTokens&&Q.defaults.extensions.childTokens[i.type]){Q.defaults.extensions.childTokens[i.type].forEach((function(t){n=n.concat(Q.walkTokens(i[t],e))}))}else if(i.tokens){n=n.concat(Q.walkTokens(i.tokens,e))}}}}return n};Q.parseInline=G(B.lexInline,H.parseInline);Q.Parser=H;Q.parser=H.parse;Q.Renderer=F;Q.TextRenderer=U;Q.Lexer=B;Q.lexer=B.lex;Q.Tokenizer=P;Q.Slugger=Y;Q.Hooks=X;Q.parse=Q;const V=":host{font-family:'Yantramanav', serif, Arial, sans-serif;line-height:1.5;font-weight:400;--main-color:#ff8834}p{all:unset}button{font-family:'Signika', serif, Arial, sans-serif}input{font-family:'Yantramanav', serif, Arial, sans-serif}.modal-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:rgba(0, 0, 0, 0.5);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;visibility:hidden;transition:opacity 0.3s ease, visibility 0.3s ease}.modal-overlay.visible{opacity:1;visibility:visible}.chat-container{width:100%;height:100%;background:white;border-radius:12px;display:flex;flex-direction:column;border:1px solid #eee;position:relative;transform:scale(0.8);transition:transform 0.3s ease}.modal-overlay.visible .chat-container{transform:scale(1)}.modal-header{display:flex;justify-content:space-between;align-items:center;padding:20px 30px;border-bottom:1px solid #eee;background:linear-gradient(135deg, var(--main-color), #ff8834);color:white;border-radius:12px 12px 0 0}.modal-title{font-family:'Signika', Arial, sans-serif;font-size:1.25rem;font-weight:600;margin:0}.close-button{background:none;border:none;color:white;font-size:1.5rem;cursor:pointer;padding:8px;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;transition:background-color 0.2s ease}.close-button:hover{background-color:rgba(255, 255, 255, 0.2)}.chat-content{flex:1;display:flex;flex-direction:column;padding:30px;min-height:0}.message-container{flex:1;overflow-y:auto;margin-bottom:20px;padding:20px;border:1px solid #eee;border-radius:8px;min-height:300px}.message{margin:12px 0;padding:12px 16px;border-radius:12px;max-width:80%;word-wrap:break-word;line-height:1.4}.user-message{background:linear-gradient(135deg, var(--main-color), #ff8834);color:white;margin-left:auto;width:fit-content;border-radius:20px 20px 0px 20px}.ai-message{background:hsla(240, 6%, 90%, 0.5);color:#333;margin-right:auto;width:fit-content;border-radius:20px 20px 20px 0px}.input-container{display:flex;gap:12px;align-items:center;background:white;padding:16px;border:1px solid #ddd;border-radius:8px}input{flex:1;padding:12px 16px;border:1px solid #ddd;border-radius:6px;font-size:1rem;outline:none;transition:border-color 0.2s ease}input:focus{border-color:var(--main-color)}button{padding:12px 24px;background:linear-gradient(135deg, var(--main-color), #ff8834);color:white;border:none;border-radius:6px;cursor:pointer;font-size:1rem;font-weight:600;transition:transform 0.2s ease, box-shadow 0.2s ease}button:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px rgba(236, 102, 7, 0.3)}button:disabled{background:#cccccc;cursor:not-allowed;transform:none;box-shadow:none}.typing-indicator{display:none;margin:12px 0;max-width:80%;margin-right:auto}.typing-indicator.active{display:block}.typing-indicator .skeleton-container{margin:0;background:transparent;border:none;padding:12px 16px}.typing-indicator .skeleton-wrapper{gap:8px}.typing-indicator .skeleton-avatar{width:24px;height:24px;margin-bottom:0}.typing-indicator .skeleton-line{height:12px}.typing-indicator .skeleton-typing{margin-top:4px}.message-container::-webkit-scrollbar{width:8px}.message-container::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.message-container::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.message-container::-webkit-scrollbar-thumb:hover{background:#a1a1a1}@media (max-width: 768px){.chat-container{width:100%;height:100%;border-radius:8px}.modal-header{padding:15px 20px}.modal-title{font-size:1.25rem}.chat-content{padding:20px}.message{max-width:90%;padding:10px 12px}.input-container{padding:12px;gap:8px}input{padding:10px 12px}button{padding:10px 16px}}.ai-feedback-buttons{display:flex;gap:8px;margin-top:8px;align-items:center}.ai-feedback-buttons button{all:unset;cursor:pointer}.ai-feedback-buttons button:hover{all:unset;cursor:pointer}.markdown-content{line-height:1.6;color:inherit}.markdown-content h1,.markdown-content h2,.markdown-content h3,.markdown-content h4,.markdown-content h5,.markdown-content h6{margin:16px 0 8px 0;font-weight:600;line-height:1.3}.markdown-content h1{font-size:1.5em}.markdown-content h2{font-size:1.4em}.markdown-content h3{font-size:1.3em}.markdown-content h4{font-size:1.2em}.markdown-content h5{font-size:1.1em}.markdown-content h6{font-size:1em}.markdown-content p{margin:8px 0;line-height:1.6}.markdown-content ul,.markdown-content ol{margin:8px 0;padding-left:24px}.markdown-content li{margin:4px 0;line-height:1.5}.markdown-content blockquote{margin:12px 0;padding:8px 16px;border-left:4px solid var(--main-color);background-color:rgba(255, 136, 52, 0.1);border-radius:4px;font-style:italic}.markdown-content code{background-color:rgba(0, 0, 0, 0.1);padding:2px 6px;border-radius:3px;font-family:'Monaco', 'Menlo', 'Ubuntu Mono', monospace;font-size:0.9em}.markdown-content pre{background-color:rgba(0, 0, 0, 0.1);padding:12px;border-radius:6px;overflow-x:auto;margin:12px 0}.markdown-content pre code{background:none;padding:0;border-radius:0}.markdown-content strong{font-weight:600}.markdown-content em{font-style:italic}.markdown-content a{color:var(--main-color);text-decoration:none}.markdown-content a:hover{text-decoration:underline}.markdown-content table{border-collapse:collapse;width:100%;margin:12px 0}.markdown-content th,.markdown-content td{border:1px solid #ddd;padding:8px 12px;text-align:left}.markdown-content th{background-color:rgba(255, 136, 52, 0.1);font-weight:600}.markdown-content hr{border:none;border-top:1px solid #ddd;margin:16px 0}.thumb-up,.thumb-down{width:16px;height:16px}@keyframes shimmer{0%{background-position:-200px 0}100%{background-position:calc(200px + 100%) 0}}.skeleton-container{position:relative}.skeleton-line{height:14px;background:linear-gradient(90deg, #e9ecef 25%, #f8f9fa 50%, #e9ecef 75%);background-size:200px 100%;animation:shimmer 1.5s infinite linear;border-radius:4px;margin-bottom:8px;position:relative;overflow:hidden}.skeleton-line:last-child{margin-bottom:0}.skeleton-line.line-1{width:95%}.skeleton-line.line-2{width:88%}.skeleton-line.line-3{width:72%}.skeleton-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(90deg, #e9ecef 25%, #f8f9fa 50%, #e9ecef 75%);background-size:200px 100%;animation:shimmer 1.5s infinite linear;margin-bottom:12px;display:inline-block}.skeleton-wrapper{display:flex;align-items:flex-start;gap:12px}.skeleton-content{flex:1}.skeleton-typing{display:flex;align-items:center;gap:4px;margin-top:8px}.skeleton-dot{width:6px;height:6px;border-radius:50%;background-color:#6c757d;animation:typing 1.4s infinite ease-in-out}.skeleton-dot:nth-child(1){animation-delay:-0.32s}.skeleton-dot:nth-child(2){animation-delay:-0.16s}.skeleton-dot:nth-child(3){animation-delay:0s}@keyframes typing{0%,80%,100%{opacity:0.3;transform:scale(0.8)}40%{opacity:1;transform:scale(1)}}.skeleton-glow{position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);animation:glow 2s infinite;border-radius:inherit}@keyframes glow{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}";const W=class{constructor(e){t(this,e)}modalTitle="Que puis-je faire pour vous ?";titleStyle={};messages=[];isLoading=false;iconSize=16;apiEndpoint=e.API_URL;conversationId="";componentWillLoad(){this.conversationId=s();console.log("Generated conversation ID:",this.conversationId);this.loadFonts();Q.setOptions({breaks:true,gfm:true})}loadFonts(){const t=document.querySelector('link[href*="fonts.googleapis.com/css2?family=Signika"]');if(!t){const t=document.createElement("link");t.rel="stylesheet";t.href="https://fonts.googleapis.com/css2?family=Signika:wght@300..700&family=Yantramanav:wght@100;300;400;500;700;900&display=swap";document.head.appendChild(t)}}handleChunk=async t=>{try{const e=this.messages.length-1;await r(t,this.apiEndpoint,this.conversationId,(t=>{this.messages=this.messages.map(((n,i)=>i===e?{...n,content:n.content+t}:n))}),(()=>{this.messages=this.messages.map(((t,n)=>n===e?{...t,isComplete:true}:t));this.isLoading=false}),(t=>{console.error("AI stream error:",t);this.messages=this.messages.map(((t,n)=>n===e?{...t,content:"Sorry, I encountered an error. Please try again.",isComplete:true}:t));this.isLoading=false}))}catch(t){console.error("Failed to call AI stream:",t);const e=this.messages.length-1;this.messages=this.messages.map(((t,n)=>n===e?{...t,content:"Sorry, I encountered an error. Please try again.",isComplete:true}:t));this.isLoading=false}};handleSubmit=async t=>{t.preventDefault();const e=t.target;const n=e.querySelector('input[name="message"]');const i=n.value;this.messages.push({role:"user",content:i});this.isLoading=true;e.reset();this.messages.push({role:"ai",content:""});await this.handleChunk(i)};renderMarkdown(t){try{const e=t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"");const n=Q(e);if(typeof n==="string"){return n.replace(/<a\s+href=/gi,'<a target="_blank" rel="noopener noreferrer" href=')}else{return e}}catch(e){console.error("Error parsing markdown:",e);return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}}render(){return n(i,{key:"ac0abb384b7f359ea6015c6f85d13f5d805cb6e6"},n("div",{key:"e815b2f798a250253b25889f7688a87bb34a1d34",class:"chat-container"},n("div",{key:"6224b0174d69b2b12961dad64649b901ae3c9329",class:"modal-header"},n("span",{key:"7f350985ef9af40b723564632496a9bb35bd8f21",class:"modal-title"},this.modalTitle)),n("div",{key:"ceed0aa80568b5f762ec1785359088c90e5415f2",class:"chat-content"},n("div",{key:"d4cbe2af9a47271803ae38cdce3ede3f435ffa8a",class:"message-container"},this.messages.map(((t,e)=>n("div",{key:e,class:{message:true,"user-message":t.role==="user","ai-message":t.role==="ai"}},t.role==="ai"?n(n.Fragment,null,this.isLoading&&t.content===""?n("chat-skeleton",null):n("div",{class:"markdown-content",innerHTML:this.renderMarkdown(t.content)}),t.isComplete&&n("satisfaction-buttons",{"conversation-id":this.conversationId,"api-endpoint":this.apiEndpoint})):n("p",null,t.content))))),n("form",{key:"55cf5f1110a05d84068329882df589406c4f3f1e",class:"input-container",onSubmit:this.handleSubmit},n("input",{key:"3e9e0dfc0c712a04deef3dabb1891ba8da1c2a73",name:"message",type:"text",placeholder:"Tapez votre message ici...",disabled:this.isLoading}),n("button",{key:"1a81c2ff1d5b0511a8caa2235cacd484b4afd20a",type:"submit",disabled:this.isLoading,class:"send-button"},this.isLoading?"Envoi...":n("svg",{xmlns:"http://www.w3.org/2000/svg",width:this.iconSize,height:this.iconSize,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-send-horizontal-icon lucide-send-horizontal"},n("path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z"}),n("path",{d:"M6 12h16"})))))))}};W.style=V;const K=":host{display:block}@keyframes shimmer{0%{background-position:-200px 0}100%{background-position:calc(200px + 100%) 0}}.skeleton-container{position:relative}.skeleton-line{height:14px;background:linear-gradient(90deg, #e9ecef 25%, #f8f9fa 50%, #e9ecef 75%);background-size:200px 100%;animation:shimmer 1.5s infinite linear;border-radius:4px;margin-bottom:8px;position:relative;overflow:hidden}.skeleton-line:last-child{margin-bottom:0}.skeleton-line.line-1{width:95%}.skeleton-line.line-2{width:88%}.skeleton-line.line-3{width:72%}.skeleton-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(90deg, #e9ecef 25%, #f8f9fa 50%, #e9ecef 75%);background-size:200px 100%;animation:shimmer 1.5s infinite linear;margin-bottom:12px;display:inline-block}.skeleton-wrapper{display:flex;align-items:flex-start;gap:12px}.skeleton-content{flex:1}.skeleton-typing{display:flex;align-items:center;gap:4px;margin-top:8px}.skeleton-dot{width:6px;height:6px;border-radius:50%;background-color:#6c757d;animation:typing 1.4s infinite ease-in-out}.skeleton-dot:nth-child(1){animation-delay:-0.32s}.skeleton-dot:nth-child(2){animation-delay:-0.16s}.skeleton-dot:nth-child(3){animation-delay:0s}@keyframes typing{0%,80%,100%{opacity:0.3;transform:scale(0.8)}40%{opacity:1;transform:scale(1)}}.skeleton-glow{position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);animation:glow 2s infinite;border-radius:inherit}@keyframes glow{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}";const tt=class{constructor(e){t(this,e)}render(){return n(i,{key:"ebdf437a8d516e0e27516e505a65c5702ae33f4b"},n("div",{key:"c1b212392b3ab4f8266da7a9f584fec3092424ea",class:"skeleton-container"},n("div",{key:"df3f4db997842505bc17545233eef3e8e036f952",class:"skeleton-typing"},n("div",{key:"6b4f9796edd6243865e65c31e399eaf38054372c",class:"skeleton-dot"}),n("div",{key:"2f0be9e8816c203079b8b2697574ac22d49f07a7",class:"skeleton-dot"}))))}};tt.style=K;const et=":host{max-width:600px;margin:0 auto;padding:20px;--main-color:#ff8834;font-family:'Yantramanav', serif, Arial, sans-serif}.chat-widget-container{position:fixed;bottom:10vh;right:24px;width:350px;background:white;border-radius:12px;box-shadow:0 2px 16px rgba(0, 0, 0, 0.15);z-index:999;display:flex;flex-direction:column;overflow:hidden}.chat-header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid #eee;background:var(--main-color);color:white;font-family:'Signika', Arial, sans-serif}.chat-title{margin:0;font-size:1.1rem;font-weight:600}.close-button{background:none;border:none;color:white;font-size:1.5rem;cursor:pointer}.message-container{flex:1;padding:16px;overflow-y:scroll;background:#f7fafc;min-height:250px;max-height:250px}.message{margin:12px 0;padding:12px 16px;border-radius:12px;max-width:80%;word-wrap:break-word;line-height:1.4}.user-message{background:linear-gradient(135deg, var(--main-color), #ff8834);color:white;margin-left:auto;width:fit-content;border-radius:20px 20px 0px 20px}.ai-message{background:hsla(240, 6%, 90%, 0.5);color:#333;margin-right:auto;width:fit-content;border-radius:20px 20px 20px 0px}.typing-indicator{min-height:24px;padding:0 16px;color:#888;font-size:0.9rem}.input-container{display:flex;border-top:1px solid #eee;padding:8px;background:#fff}.input{flex:1;border:1px solid #ccc;border-radius:6px;padding:8px;font-size:1rem;margin-right:8px;font-family:'Yantramanav', serif, Arial, sans-serif}.send-button{background:var(--main-color);color:white;border:none;border-radius:6px;padding:0 16px;font-size:1rem;cursor:pointer}.send-icon{width:20px;height:20px;vertical-align:middle}.chat-toggler{position:fixed;bottom:24px;right:24px;width:56px;height:56px;border-radius:50%;background:var(--main-color);color:white;border:none;box-shadow:0 2px 8px rgba(0, 0, 0, 0.15);display:flex;align-items:center;justify-content:center;font-size:2rem;cursor:pointer;z-index:999}.hide{display:none;opacity:0;z-index:-1;transform:translateY(50%)}.markdown-content{line-height:1.5}.markdown-content a{color:var(--main-color);text-decoration:underline}.markdown-content p{margin:0 0 8px 0}.markdown-content p:last-child{margin-bottom:0}";const nt=class{constructor(e){t(this,e)}messages=[];isLoading=false;isChatContainerVisible=true;apiEndpoint=e.API_URL;conversationId="";inputEl;componentWillLoad(){this.conversationId=s();console.log("Generated conversation ID:",this.conversationId);this.loadFonts();Q.setOptions({breaks:true,gfm:true})}loadFonts(){const t=document.querySelector('link[href*="fonts.googleapis.com/css2?family=Signika"]');if(!t){const t=document.createElement("link");t.rel="stylesheet";t.href="https://fonts.googleapis.com/css2?family=Signika:wght@300..700&family=Yantramanav:wght@100;300;400;500;700;900&display=swap";document.head.appendChild(t)}}handleSubmit=async t=>{t.preventDefault();const e=this.inputEl;if(!e||!e.value.trim())return;const n=e.value;const i={role:"user",content:n,isComplete:true};this.messages=[...this.messages,i];e.value="";this.isLoading=true;const s=this.messages.length;this.messages=[...this.messages,{role:"ai",content:"",isComplete:false}];try{await r(n,this.apiEndpoint,this.conversationId,(t=>{const e=[...this.messages];e[s].content+=t;this.messages=e}),(()=>{this.isLoading=false;const t=[...this.messages];t[s].isComplete=true;this.messages=t}),(()=>{const t=[...this.messages];t[s]={...t[s],content:"Sorry, I encountered an error. Please try again.",isComplete:true};this.messages=t;this.isLoading=false}))}catch(t){const e=[...this.messages];e[s]={...e[s],content:"Sorry, I encountered an error. Please try again.",isComplete:true};this.messages=e;this.isLoading=false}};toggleChatContainer=()=>{this.isChatContainerVisible=!this.isChatContainerVisible};setInputRef=t=>{this.inputEl=t};renderMarkdown(t){try{const e=t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"");const n=Q(e);if(typeof n==="string"){return n.replace(/<a\s+href=/gi,'<a target="_blank" rel="noopener noreferrer" href=')}else{return e}}catch(e){console.error("Error parsing markdown:",e);return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}}render(){return[n("div",{key:"67e4db44b32873c7370ba713d14308c1f8b96ded",class:{"chat-widget-container":true,hide:!this.isChatContainerVisible}},n("div",{key:"7e4eccad312a4186ed87ee3eae99db3e7175664a",class:"chat-header"},n("h3",{key:"c46bb7ceb0242bd285005ec5be3b73b232076efd",class:"chat-title"},"Que puis-je faire pour vous ?"),n("button",{key:"73b682df80d0d00e9c75969008dacd4114412d3e",class:"close-button",onClick:this.toggleChatContainer},"×")),n("div",{key:"a4ef05fdf58d519f8f7806b619b7f6a0ce9b1150",class:"message-container"},this.messages.map(((t,e)=>n("div",{key:e,class:{message:true,"user-message":t.role==="user","ai-message":t.role==="ai"}},t.role==="ai"?n(n.Fragment,null,this.isLoading&&t.content===""?n("chat-skeleton",null):n(n.Fragment,null,n("div",{class:"markdown-content",innerHTML:this.renderMarkdown(t.content)}),t.isComplete&&n("satisfaction-buttons",{"api-endpoint":this.apiEndpoint,"conversation-id":this.conversationId}))):n("span",null,t.content))))),n("form",{key:"f6011e4514459320c588ad9f39fc8b1b6bedd5c0",class:"input-container",onSubmit:this.handleSubmit},n("input",{key:"35d5c7d7a5151e93c379bada35b21bd830b70acd",type:"text",placeholder:"Tapez un message...",name:"message",required:true,class:"input",ref:this.setInputRef}),n("button",{key:"a3f26aec3409edd60fa5d9c94ab499b8fb4aa9f6",type:"submit",disabled:this.isLoading,class:"send-button"},this.isLoading?"Envoi...":n("svg",{class:"send-icon",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},n("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),n("polygon",{points:"22 2 15 22 11 13 2 9 22 2"}))))),n("button",{key:"fe77cdfe8a6c93e03d2fc59a9f38af1d265c63e1",class:"chat-toggler",onClick:this.toggleChatContainer},n("svg",{key:"d228a002cb8cf12ef59796e9a9e8fa46097fcb7d",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},n("path",{key:"3d9072039a29aeef29bed755a6472aa4695b718e",d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"})))]}};nt.style=et;class it{state=new Map;listeners=new Map;setState(t,e){this.state.set(t,e);this.notifyListeners(t,e)}getState(t){return this.state.get(t)||null}subscribe(t,e){if(!this.listeners.has(t)){this.listeners.set(t,new Set)}this.listeners.get(t).add(e);return()=>{const n=this.listeners.get(t);if(n){n.delete(e);if(n.size===0){this.listeners.delete(t)}}}}notifyListeners(t,e){const n=this.listeners.get(t);if(n){n.forEach((t=>t(e)))}}}const st=new it;const rt=":host{display:block !important;visibility:visible !important;height:auto !important;box-sizing:border-box;--btn-size:18px}button{all:unset}.satisfaction-container{gap:8px;margin-top:12px;padding:12px;width:100%;box-sizing:border-box}.satisfaction-buttons{display:flex !important;gap:8px;align-items:flex-start;justify-content:flex-start;width:100%}.satisfaction-btn{background:transparent !important;width:var(--btn-size) !important;height:var(--btn-size) !important;display:flex !important;align-items:center !important;justify-content:center !important;cursor:pointer !important;transition:all 0.2s ease !important;padding:0 !important;box-sizing:border-box !important;color:#6b7280 !important}.satisfaction-btn.active{color:#059669 !important}.satisfaction-btn.active.thumbs-down{color:#dc2626 !important}.satisfaction-btn svg{width:24px !important;height:24px !important}:host *{box-sizing:border-box !important}.satisfaction-btn,.satisfaction-btn:hover,.satisfaction-btn:active,.satisfaction-btn:focus{opacity:1 !important;visibility:visible !important}";const ot=class{constructor(e){t(this,e)}apiEndpoint=e.API_URL="https://fastt.celaneo.com";conversationId="";selectedButton=null;unsubscribe=null;componentDidLoad(){this.selectedButton=st.getState(this.conversationId);this.unsubscribe=st.subscribe(this.conversationId,(t=>{this.selectedButton=t}))}disconnectedCallback(){if(this.unsubscribe){this.unsubscribe()}}handleThumbsUp=()=>{st.setState(this.conversationId,"up");o(1,this.apiEndpoint,this.conversationId,(()=>{console.log("Thumbs up clicked")}))};handleThumbsDown=()=>{st.setState(this.conversationId,"down");o(0,this.apiEndpoint,this.conversationId,(()=>{console.log("Thumbs down clicked")}))};render(){return n(i,{key:"8ab94d482d02d447ad420170a8ea5e370c742b6d"},n("div",{key:"cb84d0e8e4a4ad503e3d1a2594b8d5d7bad83fe1",class:"satisfaction-container"},n("div",{key:"601cb432223837c4fdb42a675f1b2c31a6457319",class:"satisfaction-buttons"},n("button",{key:"000e5443a1d544851261682ac1711d0d7eaaa914",title:"Réponse utile",class:`satisfaction-btn thumbs-up ${this.selectedButton==="up"?"active":""}`,onClick:this.handleThumbsUp,"aria-label":"Réponse utile"},n("svg",{key:"50b22481b7cf901caf12860b41834f9362f9560c",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:this.selectedButton==="up"?"#ff8834":"none",stroke:this.selectedButton==="up"?"#ff8834":"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-thumbs-up-icon lucide-thumbs-up"},n("path",{key:"1797fb6e93a0d5603e9b3020b93cbe6983ebb10b",d:"M7 10v12"}),n("path",{key:"993aa0a58d8113a02067b2b8c3bf571fea02eadd",d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z"}))),n("button",{key:"3162e50bda221674c67716776721a5dc314765bb",title:"Réponse inutile",class:`satisfaction-btn thumbs-down ${this.selectedButton==="down"?"active":""}`,onClick:this.handleThumbsDown,"aria-label":"Réponse pas utile"},n("svg",{key:"b4966a5e80b1a36f498a561abb099e679c9892b5",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:this.selectedButton==="down"?"#ff8834":"none",stroke:this.selectedButton==="down"?"#ff8834":"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-thumbs-down-icon lucide-thumbs-down"},n("path",{key:"0ef105f91663cc6f1791cc12d8a338b2a98fa098",d:"M17 14V2"}),n("path",{key:"a97c165419a3c031635cc04261c31f63cc13ea70",d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z"}))))))}};ot.style=rt;export{W as chat_modal,tt as chat_skeleton,nt as chat_widget,ot as satisfaction_buttons};
//# sourceMappingURL=p-574aab9c.entry.js.map